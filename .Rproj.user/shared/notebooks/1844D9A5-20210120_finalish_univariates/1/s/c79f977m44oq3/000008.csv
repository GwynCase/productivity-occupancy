"0","# Read in the data."
"0","occupancy <- read_csv('../data/processed/occupancy_sc.csv')"
"0",""
"0","# Calculate number of years NOGO detected out of number of years surveyed."
"0","territory.quality <- occupancy %>% pivot_longer(-c(site, name), names_to='year', values_to='status') %>%"
"0","  filter(status > 0) %>% "
"0","  group_by(site, status) %>% "
"0","  add_tally() %>% "
"0","  distinct(site, status, .keep_all=TRUE) %>% "
"0","  select(-year) %>% "
"0","  pivot_wider(names_from=status, values_from=n, values_fill=0) %>% "
"0","  ungroup() %>% rowwise(site, name) %>% "
"0","  mutate(years.surveyed=sum(c(`3`, `2`, `1`)),"
"0","         years.detect=sum(c(`3`, `2`)),"
"0","         years.no.detect=years.surveyed-years.detect,"
"0","         quality.index=years.detect/years.surveyed) %>% "
"0","  select(site, name, years.surveyed, years.detect, years.no.detect, quality.index) %>% "
"0","  filter(years.surveyed > 1) %>% "
"0","  filter(years.detect >= 1)"
"0",""
"0","# Look at it."
"0","territory.quality"
