"0","# Make a spatial object."
"0","telemetry.sf <- breeding.telemetry %>% "
"0","  st_as_sf(coords=c('xcoord', 'ycoord'), remove=FALSE) %>%"
"0","  st_set_crs('+proj=utm +zone=10 +datum=WGS84 +units=m +no_defs')"
"0",""
"0","# Calculate MCPs."
"0","mcp <- telemetry.sf %>%"
"0","  select(id, geometry) %>%"
"0","  as_Spatial() %>%"
"0","  mcp.area(percent=c(50, 95), unin='m', unout='ha', plotit=FALSE) %>% "
"0","  rownames_to_column(var='percent') %>% "
"0","  pivot_longer(-percent, names_to='id', values_to='area') %>% "
"0","  mutate(method='mcp')"
"0",""
"0","# Calculate KDEs."
"0","kde <- telemetry.sf %>%"
"0","  select(id, geometry) %>%"
"0","  as_Spatial() %>%"
"0","  kernelUD() %>% "
"0","  kernel.area(percent=c(50, 95), unin='m', unout='ha') %>% "
"0","  rownames_to_column(var='percent') %>% "
"0","  pivot_longer(-percent, names_to='id', values_to='area') %>% "
"0","  mutate(method='kde')"
"0",""
"0","# And in the darkness bind them."
"0","homerange <- bind_rows(mcp, kde)"
"0",""
"0","# Also calculate maximum distance."
"0","max.dist <- telemetry.sites %>% select(n.xcoord=x_coord, n.ycoord=y_coord, nest) %>% "
"0","  right_join(breeding.telemetry, by=c('nest')) %>% "
"0","  mutate(dist=sqrt((xcoord-n.xcoord)^2 + (ycoord-n.ycoord)^2)) %>% "
"0","  group_by(id) %>% "
"0","  arrange(desc(dist)) %>% "
"0","  slice(1) %>% "
"0","  select(id, dist, sex)"
"0",""
"0","# Calculate number of points taken at nest."
"0","nest.points <- breeding.telemetry %>% group_by(id) %>% "
"0","  mutate(total.points=n(), base.points=sum(at.base), prop.at.base=base.points/total.points*100) %>% "
"0","  distinct(id, sex, site, prop.at.base)"
