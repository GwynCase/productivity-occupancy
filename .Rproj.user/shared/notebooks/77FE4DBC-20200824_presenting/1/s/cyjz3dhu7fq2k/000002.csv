"0","# As an additional, larger size, use the maximum distance birds are observed to travel, using telemetry data."
"0",""
"0","# Load in the telemetry data."
"0","telemetry <- read_csv('../data/processed/telemetry_2018-2019.csv') %>%  drop_na('lat')"
"0",""
"0","# Convert telemetry data to a spatial object."
"0","telemetry <- st_as_sf(telemetry, coords=c('lon', 'lat')) %>%"
"0","  st_set_crs('+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs') %>%"
"0","  st_transform(""+proj=utm +zone=10 +datum=WGS84 +units=m +no_defs"")"
"0",""
"0","# Define the dates of the breeding season."
"0","# Incubation starts about April 15 and fledglings leave the nest area around September 1."
"0","# These dates come from Vancouver Island again."
"0","breeding.2018 <- interval(ymd(20180415), ymd(20180901))"
"0","breeding.2019 <- interval(ymd(20190415), ymd(20190901))"
"0",""
"0","# Which birds are males?"
"0","# Since males do the foraging, it makes sense to define maximum foraging area by male, not female, movement."
"0","tagged.males <- c('HAR07', 'HAR09', 'HAR04', 'HAR05')"
"0",""
"0","# Filter telemetry locations to those from males during the breeding season."
"0","telemetry <- telemetry %>% filter(datetime %within% breeding.2018 | breeding.2019) %>% "
"0","  filter(id %in% tagged.males) %>% "
"0","  mutate(nest=paste(site, year(datetime), sep=''))"
"0",""
"0","# Break the geometry column into separate x and y coordinates."
"0","telemetry <- st_coordinates(telemetry) %>% data.frame() %>% "
"0","  bind_cols(telemetry)"
"0",""
"0","# Load the locations of the telemetry nests."
"0","telemetry.sites <- read_csv('../data/raw/telemetry_sites.csv') %>% "
"0","  select(nest, x_coord, y_coord)"
"0",""
"0","# Join the data sets together and do some math."
"0","telemetry <- left_join(telemetry, telemetry.sites, by='nest') %>% "
"0","  mutate(distance=sqrt((x_coord-X)^2 + (y_coord-Y)^2)) %>% "
"0","  group_by(nest) %>% "
"0","  arrange(desc(distance)) %>% slice(1) "
"0",""
"0","# Add the mean distance to the landscapes data frame."
"0","landscape <- data.frame(size='maximum range', area=NA, radius=mean(telemetry$distance)) %>% "
"0","  bind_rows(landscape) %>% "
"0","  arrange(radius)"
"0",""
"0","# Calculate area of maximum range."
"0","landscape[4,2] <- (pi*landscape[4,3]^2)*0.0001"
