"0","# Calculate % biomass for each source and each zone."
"0","zone.mass <- left_join(diet.items, centroids.sf, by=c('site')) %>% "
"0","    group_by(zone, source) %>% nest() %>%  "
"0","    mutate(class=map(data, class.mass), "
"0","           genus=map(data, squirrel.mass), "
"0","           group=map(data, group.mass)) %>% "
"0","    select(!data) %>% "
"0","    pivot_longer(-c(source, zone), names_to='var', values_to='per') %>% "
"0","    unnest(per) %>% "
"0","    select(source, zone, variable, percent) %>% "
"0","    pivot_wider(id_cols=c(zone, variable), names_from=source, values_from=percent, values_fill=0) %>%"
"0","    mutate(R.P=R + P) %>% "
"0","    arrange(zone)"
"0",""
"0","# Calculate counts of items identified to genus for each zone."
"0","zone.count <- left_join(diet.items, centroids.sf, by=c('site')) %>% "
"0","  filter(source == 'C' & binomial != 'Unidentified item') %>% "
"0","  group_by(zone, binomial) %>% "
"0","  mutate(count=n()) %>% "
"0","  select(zone, binomial, count) %>% "
"0","  distinct() %>% "
"0","  pivot_wider(names_from=binomial, values_from=count, values_fill=list(count = 0))"
"0",""
"0","# Diversity per zone (pooled)."
"0","zone.diversity <- plyr::ddply(zone.count, ~zone, function(x) {"
"0","  data.frame(diet.diversity=diversity(x[-1], index='simpson'))"
"0","})"
"0",""
"0","# Diversity per zone per nest."
"0","zone.nest.diversity <- diet.items %>% distinct(site, nest) %>% "
"0","  right_join(nest.diversity, by=c('nest')) %>% "
"0","  left_join(centroids.sf, by=c('site')) %>% "
"0","  select(site, nest, diet.diversity, zone)"
"0",""
"0","# Mean diversity per nest for the transition zone."
"0","mean.diversity.tz <- zone.nest.diversity %>% filter(zone == 'tz') %>% "
"0","  summarize(mean(diet.diversity)) %>% peretty()"
"0",""
"0","# Mean diversity per nest for the coastal zone."
"0","mean.diversity.cs <- zone.nest.diversity %>% filter(zone == 'cs') %>% "
"0","  summarize(mean(diet.diversity)) %>% peretty()"
"0",""
"0","# Overlap between zones (pooled)."
"0","zone.overlap <- zone.count %>% column_to_rownames(var='zone') %>% "
"0","  vegdist(., method='morisita') %>% "
"0","  as.numeric()"
