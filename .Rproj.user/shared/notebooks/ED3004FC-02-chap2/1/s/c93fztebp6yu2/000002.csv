"0","# Chi-square test for difference in prey groups between years."
"0",""
"0","# Calculate counts per year per source."
"0","year.counts <- diet.items %>% "
"0","  group_by(source) %>% nest() %>% "
"0","  mutate(count=map(data, function(data) {"
"0","    data %>% group_by(year, group) %>% "
"0","      mutate(count=n()) %>% "
"0","      select(year, group, count) %>% "
"0","      distinct()"
"0","  })) %>% "
"0","  unnest(count) %>% select(!data)"
"0",""
"0","# Run chi-square test."
"0","year.chi <- year.counts %>% pivot_wider(names_from=source, values_from=count) %>% "
"0","  mutate(RP=R + P) %>% "
"0","  pivot_longer(cols=c('R', 'C', 'P', 'RP'), names_to='source', values_to='count') %>% "
"0","  filter(!is.na(count)) %>% "
"0","  group_by(source) %>% nest() %>% "
"0","  mutate(ch=map(data, function(data) {"
"0","    data %>% pivot_wider(names_from=group, values_from=count, values_fill=0) %>% "
"0","      column_to_rownames(var='year') %>% "
"0","      chisq.test(., correct=FALSE, simulate.p.value=TRUE)"
"0","  }),"
"0","  gl=map(ch, glance))"
"0",""
"0","# t-test for difference in diversity between years."
"0",""
"0","# Annotate diversity with year."
"0","nest.diversity.w.year <- nest.diversity %>% mutate(year=str_extract(.$nest, '([0-9]{4})'))"
"0",""
"0","# Run the t-test."
"0","diversity.test.year.nest <- t.test(diet.diversity ~ year, data=nest.diversity.w.year)"
"0",""
"0","# p-value for unpaired two-sample t-test for diet diversity between years."
"0","p.value.diversity.year <- diversity.test.year.nest %>% "
"0","  glance() %>% select(p.value) %>% peretty()"
"0",""
"0","# df for t-test of diversity by year."
"0","df.diversity.year.test <- diversity.test.year.nest %>% tidy() %>% select(parameter) %>% peretty()"
"0",""
"0","# t-statistic for t-test of diversity by year."
"0","stat.diversity.year.test <- diversity.test.year.nest %>% tidy() %>% select(statistic) %>% peretty()"
"0",""
"0","# Mean diversity for 2019."
"0","mean.diversity.2019 <- filter(nest.diversity.w.year, year == '2019') %>% "
"0","  summarize(mean=mean(diet.diversity)) %>% "
"0","  as.numeric() %>% peretty()"
"0",""
"0","# SD diversity for 2019"
"0","sd.diversity.2019 <- filter(nest.diversity.w.year, year == '2019') %>% "
"0","  summarize(sd=sd(diet.diversity)) %>% "
"0","  as.numeric() %>% peretty()"
"0",""
"0","# Mean diversity for 2020."
"0","mean.diversity.2020 <- filter(nest.diversity.w.year, year == '2020') %>% "
"0","  summarize(mean=mean(diet.diversity)) %>% "
"0","  as.numeric() %>% peretty()"
"0",""
"0","# SD diversity for 2020."
"0","sd.diversity.2020 <- filter(nest.diversity.w.year, year == '2020') %>% "
"0","  summarize(sd=sd(diet.diversity)) %>% "
"0","  as.numeric() %>% peretty()"
"0",""
"0","# t-test for difference in proportion squirrel between years."
"0",""
"0","# Annotate squirrel biomass with year."
"0","nest.mass.w.year <- nest.mass"
"0","nest.mass.w.year$year <- str_extract(nest.mass.w.year$nest, '([0-9]{4})')"
"0",""
"0","# Run the t-test."
"0","squirrel.biomass.test.year.nest <- t.test(Tamiasciurus ~ year, data=nest.mass.w.year)"
"0",""
"0","# p-value for unpaired two-sample t-test for squirrel biomass between years."
"0","p.value.squirrel.year <- squirrel.biomass.test.year.nest %>% "
"0","  glance() %>% select(p.value) %>% peretty()"
"0",""
"0","# df for t-test of squirrel biomass by year."
"0","df.squirrel.year.test <- squirrel.biomass.test.year.nest %>% tidy() %>% "
"0","  select(parameter) %>% peretty()"
"0",""
"0","# t-statistic for t-test of squirrel biomass by year."
"0","stat.squirrel.year.test <- squirrel.biomass.test.year.nest %>% tidy() %>% "
"0","  select(statistic) %>% peretty()"
"0",""
"0","# Mean squirrel biomass for 2019."
"0","mean.squirrel.2019 <- filter(nest.mass.w.year, year == '2019') %>% ungroup() %>% "
"0","  summarize(mean=mean(Tamiasciurus), .groups='drop') %>% "
"0","  as.numeric() %>% peretty()"
"0",""
"0","# SD squirrel biomass for 2019"
"0","sd.squirrel.2019 <- filter(nest.mass.w.year, year == '2019') %>% ungroup() %>% "
"0","  summarize(sd=sd(Tamiasciurus), .groups='drop') %>% "
"0","  as.numeric() %>% peretty()"
"0",""
"0","# Mean squirrel for 2020."
"0","mean.squirrel.2020 <- filter(nest.mass.w.year, year == '2020') %>% ungroup() %>% "
"0","  summarize(mean=mean(Tamiasciurus), .groups='drop') %>% "
"0","  as.numeric() %>% peretty()"
"0",""
"0","# SD squirrel for 2020."
"0","sd.squirrel.2020 <- filter(nest.mass.w.year, year == '2020') %>% ungroup() %>% "
"0","  summarize(sd=sd(Tamiasciurus), .groups='drop') %>% "
"0","  as.numeric() %>% peretty()"
"0",""
"0","# t-test for difference in between years."
"0",""
"0","# Run the t-test."
"0","productivity.year.test <- t.test(n.fledge ~ as.factor(year), data=productivity)"
"0",""
"0","# p-value for unpaired two-sample t-test for productivity between years."
"0","p.value.productivity.year <- productivity.year.test %>% "
"0","  glance() %>% select(p.value) %>% peretty()"
"0",""
"0","# df for t-test of productivity by year."
"0","df.productivity.year.test <- productivity.year.test %>% tidy() %>% "
"0","  select(parameter) %>% peretty()"
"0",""
"0","# t-statistic for t-test of productivity by year."
"0","stat.productivity.year.test <- productivity.year.test %>% tidy() %>% "
"0","  select(statistic) %>% peretty()"
"0",""
"0","# Mean productivity for 2019."
"0","mean.productivity.2019 <- filter(productivity, year == '2019') %>% ungroup() %>% "
"0","  summarize(mean=mean(n.fledge), .groups='drop') %>% "
"0","  as.numeric() %>% peretty()"
"0",""
"0","# SD productivity for 2019"
"0","sd.productivity.2019 <- filter(productivity, year == '2019') %>% ungroup() %>% "
"0","  summarize(sd=sd(n.fledge), .groups='drop') %>% "
"0","  as.numeric() %>% peretty()"
"0",""
"0","# Mean productivity for 2020."
"0","mean.productivity.2020 <- filter(productivity, year == '2020') %>% ungroup() %>% "
"0","  summarize(mean=mean(n.fledge, na.rm=TRUE), .groups='drop') %>% "
"0","  as.numeric() %>% peretty()"
"0",""
"0","# SD squirrel for 2020."
"0","sd.productivity.2020 <- filter(productivity, year == '2020') %>% ungroup() %>% "
"0","  summarize(sd=sd(n.fledge, na.rm=TRUE), .groups='drop') %>% "
"0","  as.numeric() %>% peretty()"
