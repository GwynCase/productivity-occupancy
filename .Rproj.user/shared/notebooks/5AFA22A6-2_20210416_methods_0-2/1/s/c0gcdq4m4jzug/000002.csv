"0","# Proportion suitable."
"0","proportion.suitable.model <- function(df) {"
"0","  glm(cbind(years.detect, years.no.detect) ~ proportion.suitable, data=df, family=binomial(logit))"
"0","}"
"0",""
"0","# Proportion suitable + suitable edge density."
"0","suitable.edge.density.model <- function(df) {"
"0","  glm(cbind(years.detect, years.no.detect) ~ proportion.suitable + suitable.edge.density, data=df, family=binomial(logit))"
"0","}"
"0",""
"0","# Proportion mature forest."
"0","proportion.mature.model <- function(df) {"
"0","  glm(cbind(years.detect, years.no.detect) ~ proportion.cover.mature, data=df, family=binomial(logit))"
"0","}"
"0",""
"0","# Proportion mature + gap edge density"
"0","mature.edge.density.model <- function(df) {"
"0","  glm(cbind(years.detect, years.no.detect) ~ proportion.cover.mature + gap.edge.density, data=df, family=binomial(logit))"
"0","}"
"0",""
"0","# Proportion mature + mature edge density."
"0","mature.edge.model <- function(df) {"
"0","  glm(cbind(years.detect, years.no.detect) ~ proportion.cover.mature + gap.edge.density, data=df, family=binomial(logit))"
"0","}"
"0",""
"0","# Null."
"0","null.model <- function(df) {"
"0","  glm(cbind(years.detect, years.no.detect) ~ 1, data=df, family=binomial(logit))"
"0","}"
"0",""
"0","# Nest the data frame."
"0","nf <- occupancy.data %>% group_by(size) %>% nest()"
"0",""
"0","# Apply the models."
"0","nf <- nf %>% "
"0","  mutate("
"0","    m.proportion.suitable=map(data, proportion.suitable.model),"
"0","    m.suitable.edge.density=map(data, suitable.edge.density.model),"
"0","    m.proportion.mature=map(data, proportion.mature.model),"
"0","    m.mature.edge.density=map(data, mature.edge.density.model),"
"0","    m.mature.edge=map(data, mature.edge.model),"
"0","    m.null=map(data, null.model)"
"0","         )"
