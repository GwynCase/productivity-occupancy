"0","# Run the chi-squared test."
"0","zone.chi <- zone.counts %>% pivot_wider(names_from=source, values_from=count, values_fill=0) %>% "
"0","    mutate(RP=R + P) %>% "
"0","    pivot_longer(cols=c('R', 'C', 'P', 'RP'), names_to='source', values_to='count') %>% "
"0","    filter(count > 0) %>% "
"0","    group_by(source) %>% nest() %>% "
"0","    mutate(ch=map(data, function(data) {"
"0","      data %>% pivot_wider(names_from=group, values_from=count, values_fill=0) %>% "
"0","        column_to_rownames(var='zone') %>% "
"0","        chisq.test(., correct=FALSE, simulate.p.value=TRUE)"
"0","    }),"
"0","    gl=map(ch, glance))"
"0",""
"0","# Look at the results."
"0","zone.chi %>% unnest(gl)"
