"0","# Calculate counts per group per zone per source."
"0","zone.counts <- left_join(diet.items, centroids.sf, by=c('site')) %>% "
"0","  group_by(source) %>% nest() %>% "
"0","  mutate(count=map(data, function(data) {"
"0","    data %>% group_by(zone, group) %>% "
"0","      mutate(count=n()) %>% "
"0","      select(zone, group, count) %>% "
"0","      distinct()"
"0","  })) %>% "
"0","  unnest(count) %>% select(!data)"
"0",""
"0","# Run a chi-square test for each data source."
"0","zone.chi <- zone.counts %>% group_by(source) %>% nest() %>% "
"0","  mutate(ch=map(data, function(data) {"
"0","    data %>% pivot_wider(names_from=group, values_from=count, values_fill=0) %>% "
"0","      column_to_rownames(var='zone') %>% "
"0","      chisq.test(., correct=FALSE, simulate.p.value=TRUE)"
"0","  })) "
