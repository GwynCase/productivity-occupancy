"0","# Bring in specimen data."
"0","remains.data <- read_csv('../data/raw/20210118_specimens.csv', guess_max=7000) %>% "
"0","  ## filter only records with at least size assigned..."
"0","  filter(size != 'U') %>% "
"0","  ## and rename a confusing column."
"0","  rename(name=site)"
"0",""
"0","# Bring in camera data."
"0","camera.data <- read_csv('../data/interim/camera_corrected.csv', guess_max=7000) %>% "
"0","  ## filter only records with at least size assigned..."
"0","  filter(size != 'Unknown')"
"0",""
"0","# Bring in a list of site abbreviations and site names."
"0","nest.list <- read_csv('../data/processed/site_abbreviations.csv')"
"0",""
"0","# Standardize the specimen data."
"0",""
"0","# NOTE ON DROPPED ITEMS"
"0","# Comsock is a site with no NOGO nest associated with it, likely not NOGO prey remains."
"0","# Item 1120 misidentified as SSHA, but later re-IDed as dead NOGO chick, not prey."
"0","# Item 1171 misidentified as prey, but actually shed feather."
"0","remains.data <- left_join(remains.data, nest.list, by='name') %>% "
"0","  filter(id != 1120) %>% "
"0","  filter(id != 1171) %>% "
"0","  filter(site != 'COM') %>% "
"0","  select(site, date, class, order, family, genus, species, common, size, source)"
"0",""
"0","# Standardize the camera data."
"0","camera.data <- camera.data %>% "
"0","  mutate(date=date(datetime), source='C') %>% "
"0","  select(site, date, class, order, family, genus, species, common, size, source)"
"0",""
"0","# Join them together."
"0","diet.data <- bind_rows(remains.data, camera.data)"
"0",""
"0","# Add a unique site/year identifier."
"0","diet.data <- diet.data %>% "
"0","  mutate(year=year(date), nest=paste(site, year, sep=''))"
"0",""
"0","# Do some cleanup."
"0","diet.data <- diet.data %>% "
"0","  mutate(size=case_when("
"0","    size %in% c('S', 'Small') ~ 'small',"
"0","    size %in% c('M', 'Medium') ~ 'medium',"
"0","    size %in% c('L', 'Large') ~ 'large'"
"0","  )) %>%  "
"0","  ## and replace all the ""U""s with ""Unknown""..."
"0","  mutate_at(c('class', 'order', 'family', 'genus'), funs(case_when("
"0","    . == 'U' ~ 'Unknown',"
"0","    TRUE ~ ."
"0","  ))) %>% "
"0","  ## in species as well..."
"0","  mutate(species=case_when("
"0","    species == 'U' ~ 'unknown',"
"0","    TRUE ~ species"
"0","  ))"
"0",""
"0","# Make sure species is lowercase."
"0","diet.data$species <- str_to_lower(diet.data$species)"
"0",""
"0","# Make sure common name is lowercase."
"0","diet.data$common <- str_to_lower(diet.data$common)"
