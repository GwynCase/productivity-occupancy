"0","# Make a function to calculate class mass."
"0","class.mass <- function(data) {"
"0","    data %>% mutate(total.mass=sum(.data$mass)) %>%"
"0","    filter(class %in% c('Mammalia', 'Aves')) %>%"
"0","    group_by(class) %>% "
"0","    mutate(class.mass=sum(.data$mass), per.class=class.mass/total.mass*100) %>% "
"0","    distinct(class, per.class) %>% "
"0","    rename(variable=class, percent=per.class)"
"0","}"
"0",""
"0","# And a function to calculate squirrel mass."
"0","squirrel.mass <- function(data) {"
"0","    data %>% mutate(total.mass=sum(.data$mass)) %>%"
"0","    filter(genus == 'Tamiasciurus') %>%"
"0","    mutate(genus.mass=sum(.data$mass), per.genus=genus.mass/total.mass*100) %>% "
"0","    distinct(genus, per.genus) %>% "
"0","    rename(variable=genus, percent=per.genus)"
"0","}"
"0",""
"0","# And a function to calculate mass of each group."
"0","group.mass <- function(data) {"
"0","  data %>% mutate(total.mass=sum(.data$mass)) %>%"
"0","    group_by(group) %>% "
"0","    mutate(group.mass=sum(.data$mass), per.group=group.mass/total.mass*100) %>% "
"0","    distinct(group, per.group) %>% "
"0","    rename(variable=group, percent=per.group)"
"0","}"
"0",""
"0","# Calculate biomass for study area. "
"0","study.area.mass <- diet.items %>% group_by(source) %>% nest() %>%  "
"0","  mutate(class=map(data, class.mass), "
"0","         genus=map(data, squirrel.mass), "
"0","         group=map(data, group.mass)) %>%"
"0","  pivot_longer(-c(source, data), names_to='var', values_to='per') %>% "
"0","  unnest(per) %>% "
"0","  select(source, variable, percent) %>% "
"0","  pivot_wider(names_from=source, values_from=percent, values_fill=0) %>% "
"0","  mutate(R.P=R + P)"
