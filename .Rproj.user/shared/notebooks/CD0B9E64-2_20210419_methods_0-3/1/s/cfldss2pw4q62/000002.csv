"0","# Proportion suitable."
"0","proportion.suitable.model <- function(df) {"
"0","  glm(cbind(years.detect, years.no.detect) ~ proportion.suitable, data=df, family=binomial(logit))"
"0","}"
"0",""
"0","# Proportion suitable + suitable edge density."
"0","suitable.plus.suitable.edge.model <- function(df) {"
"0","  glm(cbind(years.detect, years.no.detect) ~ proportion.suitable + suitable.edge.density, data=df, family=binomial(logit))"
"0","}"
"0",""
"0","# Proportion suitable + HSI edge density."
"0","suitable.plus.hsi.edge.model <- function(df) {"
"0","  glm(cbind(years.detect, years.no.detect) ~ proportion.suitable + hsi.edge.density, data=df, family=binomial(logit))"
"0","}"
"0",""
"0","# Proportion mature forest."
"0","proportion.mature.model <- function(df) {"
"0","  glm(cbind(years.detect, years.no.detect) ~ proportion.mature, data=df, family=binomial(logit))"
"0","}"
"0",""
"0","# Proportion mature forest + openings edge density"
"0","mature.plus.openings.edge.model <- function(df) {"
"0","  glm(cbind(years.detect, years.no.detect) ~ proportion.mature + gap.edge.density, data=df, family=binomial(logit))"
"0","}"
"0",""
"0","# Proportion mature forest + mature forest edge density."
"0","mature.plus.mature.edge.model <- function(df) {"
"0","  glm(cbind(years.detect, years.no.detect) ~ proportion.mature + mature.edge.density, data=df, family=binomial(logit))"
"0","}"
"0",""
"0","# Proportion high canopy cover."
"0","proportion.high.canopy.model <- function(df) {"
"0","  glm(cbind(years.detect, years.no.detect) ~ proportion.canopy.high, data=df, family=binomial(logit))"
"0","}"
"0",""
"0","# Proportion high canopy cover + high canopy fragmentation."
"0","high.canopy.plus.canopy.edge.model <- function(df) {"
"0","  glm(cbind(years.detect, years.no.detect) ~ proportion.canopy.high + canopy.high.edge.density, data=df, family=binomial(logit))"
"0","}"
"0",""
"0","# Null."
"0","null.model <- function(df) {"
"0","  glm(cbind(years.detect, years.no.detect) ~ 1, data=df, family=binomial(logit))"
"0","}"
"0",""
"0","# Nest the data frame."
"0","nf <- occupancy.data %>% group_by(size) %>% nest()"
"0",""
"0","# Apply the models."
"0","nf <- nf %>% "
"0","  mutate("
"0","    # Suitability models."
"0","    m.proportion.suitable=map(data, proportion.suitable.model),"
"0","    m.suitable.plus.suitable.edge=map(data, suitable.plus.suitable.edge.model),"
"0","    m.suitable.plus.hsi.edge=map(data, suitable.plus.hsi.edge.model),"
"0","    # Mature forest models."
"0","    m.proportion.mature=map(data, proportion.mature.model),"
"0","    m.mature.plus.openings.edge=map(data, mature.plus.openings.edge.model),"
"0","    m.mature.plus.mature.edge=map(data, mature.plus.mature.edge.model),"
"0","    # Canopy cover models."
"0","    m.proportion.high.canopy=map(data, proportion.high.canopy.model),"
"0","    m.high.canopy.plus.canopy.edge=map(data, high.canopy.plus.canopy.edge.model),"
"0","    # Null model."
"0","    m.null=map(data, null.model)"
"0","         )"
