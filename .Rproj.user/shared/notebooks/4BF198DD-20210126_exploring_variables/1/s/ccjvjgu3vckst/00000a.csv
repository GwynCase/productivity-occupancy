"0","# Bring in a list of nests and calculate a centroid for each territory."
"0","centroids <- read_csv('../data/processed/sc_nests.csv') %>% "
"0","  group_by(site) %>% "
"0","  mutate(mean.x=mean(xcoord), mean.y=mean(ycoord)) %>% "
"0","  distinct(site, name, mean.x, mean.y)"
"0",""
"0","# Make it spatial."
"0","centroids.sf <- centroids %>% rename(xcoord=mean.x, ycoord=mean.y)"
"0",""
"0","centroids.sf <- centroids.sf %>% st_as_sf(coords=c('xcoord', 'ycoord')) %>% "
"0","  st_set_crs('+proj=utm +zone=10 +datum=WGS84 +units=m +no_defs')"
"0",""
"0","# Define some radii."
"0","hr <- 3477.8982"
"0","mr <- 7046.7256"
"0",""
"0","# Load suitable habitat raster."
"0","r.suitable <- raster('../data/processed/foraging_sc_suitable.tif')"
"0",""
"0","# Define levels."
"0","suitable.levels <- data.frame(ID=c(0, 4), "
"0","                              class.name=c('unsuitable', 'suitable'))"
"0",""
"0","# Add to the raster."
"0","levels(r.suitable) <- suitable.levels"
"0",""
"0","# Pull one site."
"0","gmt <- centroids.sf %>% filter(site == 'GMT')"
"0",""
"0","# Convert to polygon with max range radius."
"0","gmt.mr <- st_buffer(gmt$geometry, mr) %>% st_sf()"
"0",""
"0","# Also make a smaller one with home range radius."
"0","gmt.hr <- st_buffer(gmt$geometry, hr) %>% st_sf()"
"0",""
"0","# Crop raster to larger extent."
"0","gmt.suitable <- crop(r.suitable, gmt.mr)"
"0",""
"0","# Plot it."
"0","raster::as.data.frame(gmt.suitable, xy=TRUE) %>% "
"0","  ggplot() +"
"0","  geom_raster(aes(x=x, y=y, fill=foraging_sc_suitable_class.name)) +"
"0","  geom_sf(data=gmt.hr, fill=NA) +"
"0","  labs(title='Granite Mountain suitable habitat (home range)') +"
"0","  theme_void()"
