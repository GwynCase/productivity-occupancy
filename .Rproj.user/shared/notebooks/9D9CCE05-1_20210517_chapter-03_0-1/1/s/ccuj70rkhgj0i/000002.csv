"0","# Make the summary table."
"0","summary.table <- breeding.telemetry %>% group_by(id) %>% "
"0","  mutate(min=min(date), max=max(date), n.points=n(), period=max-min) %>% "
"0","  distinct(id, site, n.points, min, max, period) %>% "
"0","  left_join(max.dist, by=c('id')) %>% "
"0","  left_join(homerange, by=c('id')) %>% "
"0","  left_join(nest.points, by=c('id', 'site', 'sex')) %>% "
"0","  pivot_wider(names_from=c(method, percent), names_sep='.', values_from=area) %>% "
"0","  arrange(sex, site) %>%"
"0","  rownames_to_column(var='order') %>% mutate(order=as.numeric(order)) %>% "
"0","  mutate(order=case_when("
"0","    sex == 'f' ~ order - 1,"
"0","    sex == 'm' ~ order,"
"0","    TRUE ~ order"
"0","  ),"
"0","  period=as.numeric(period)) %>% "
"0","  mutate(., across(where(is.numeric), round, digits=2))"
"0",""
"0","# Find where total rows should be inserted."
"0","table.breaks <- summary.table %>% group_by(sex) %>% "
"0","  summarize(max=max(order), .groups='drop') %>% ungroup() %>% "
"0","  select(max) %>% as.vector()"
"0",""
"0","# Summarize female data."
"0","female.summary <- summary.table %>% filter(sex == 'f') %>% ungroup() %>%  "
"0","  summarise(., across(where(is.numeric), mean)) %>% "
"0","  mutate(order=table.breaks$max[1] + 1, id='AVERAGE', site=NA, min=NA, max=NA, n.points=NA, sex='f')"
"0",""
"0","# Summarize male data."
"0","male.summary <- summary.table %>% filter(sex == 'm') %>% ungroup() %>%  "
"0","  summarise(., across(where(is.numeric), mean)) %>% "
"0","  mutate(order=table.breaks$max[2] + 1, id='AVERAGE', site=NA, min=NA, max=NA, n.points=NA, sex='m')"
"0",""
"0","bind_rows(summary.table, female.summary, male.summary) %>% "
"0","  arrange(order) %>% column_to_rownames(var='order') %>% "
"0","  select(-sex) %>% relocate(n.points, .after=period) %>% "
"0","  flextable() %>% "
"0","  colformat_num(na_str='-', digits=0) %>% "
"0","  add_header_row(values=c(' ', 'Days of data collected', 'Relation to nest', 'Home range (ha)'), "
"0","                 colwidths=c(2, 3, 3, 4)) %>% "
"0","  set_header_labels(id='ID', site='Site', min='first', max='last', n.points='N. points',"
"0","                    period='N. days', dist='Max. distance from nest (m)', "
"0","                    prop.at.base='% points taken at nest',"
"0","                    mcp.50='50% MCP', mcp.95='95% MCP', kde.50='50% KDE', kde.95='95% KDE')"
