"0","# Import conflict settings."
"0","source('../src/conflicted.R')"
"0",""
"0","# Load some libraries."
"0","library(tidyverse)"
"0","library(lubridate)"
"0","library(sf)"
"0","library(adehabitatHR)"
"0","library(recurse)"
"0","library(flextable)"
"0","library(rmapshaper)"
"0","library(ggspatial)"
"0","library(ggrepel)"
"0",""
"0","# Copy out results from Bloxton."
"0","blx <- tribble("
"0","  ~class, ~family, ~category, ~common, ~prop.count,"
"0","  'Aves', 'Phasianidae', 'large bird', 'grouse', 31,"
"0","  'Aves', 'Columbidae', 'large bird', 'band-tailed pigeon', 22,"
"0","  'Aves', 'Corvidae', 'medium bird', ""steller\'s jay"", 14,"
"0","  'Aves', 'Picidae', 'medium bird', 'woodpecker', 4,"
"0","  'Aves', 'Turdidae', 'small bird', 'thrush', 4,"
"0","  'Aves', 'Unknown', 'small bird', 'unknown', 2,"
"0","  'Mammalia', 'Leporidae', 'large mammal', 'snowshoe hare', 10,"
"0","  'Mammalia', 'Sciuridae', 'medium mammal', 'douglas squirrel', 6,"
"0","  'Mammalia', 'Sciuridae', 'small mammal', 'flying squirrel', 4,"
"0","  'Mammalia', 'Rodentia', 'small mammal', 'unknown', 3"
"0",")"
"0",""
"0","# This assumes ""other birds"" and ""other mammals"" are ""small"" sized, and splits woodpeckers and thrushes (which he gives as a combine 8%) into 4% each."
"0",""
"0","# Copy out results from Thraikill."
"0","thr <- tribble("
"0","  ~class, ~family, ~category, ~common, ~prop.count,"
"0","  'Aves', 'Phasianidae', 'large bird', 'ruffed grouse', 45,"
"0","  'Aves', 'Corvidae', 'medium bird', ""steller\'s jay"", 13,"
"0","  'Aves', 'Turdidae', 'medium bird', 'american robin', 13,"
"0","  'Aves', 'Phasianidae', 'large bird', 'ring-necked pheasant', 8,"
"0","  'Aves', 'Odontophoridae', 'large bird', 'mountain quail', 5,"
"0","  'Mammalia', 'Sciuridae', 'medium mammal', 'douglas squirrel', 13,"
"0","  'Mammalia', 'Aplodontiidae', 'large mammal', 'mountain beaver', 3"
"0",")"
"0",""
"0","# Copy out results from Ethier."
"0","eth <- tribble("
"0","  ~class, ~family, ~category, ~common, ~frequency,"
"0","  'Aves', 'Turdidae', 'medium bird', 'varied thrush', 39,"
"0","  'Aves', 'Corvidae', 'medium bird', ""steller\'s jay"", 38,"
"0","  'Aves', 'Picidae', 'medium bird', 'northern flicker', 34,"
"0","  'Aves', 'Alcidae', 'large bird', 'marbled murrelet', 15,"
"0","  'Aves', 'Columbidae', 'large bird', 'band-tailed pigeon', 5,"
"0","  'Aves', 'Corvidae', 'medium bird', 'gray jay', 4,"
"0","  'Aves', 'Hirundinidae', 'small bird', 'barn swallow', 2,"
"0","  'Aves', 'Strigidae', 'medium bird', 'northern pygmy owl', 1,"
"0","  'Aves', 'Turdidae', 'small bird', 'swainson\'s thrush', 1,"
"0","  'Aves', 'Tyrannidae', 'small bird', 'western wood-peewee', 1,"
"0","  'Mammalia', 'Sciuridae', 'medium mammal', 'red squirrel', 69,"
"0","  'Mammalia', 'Cricetidae', 'small mammal', 'vole', 1,"
"0","  'Mammalia', 'Unknown', 'small mammal', 'unknown', 1"
"0",")"
"0",""
"0","# Ethier's results are WRONG!!!!! Must convert to percents."
"0","eth <- eth %>% "
"0","  mutate(total.count=sum(frequency), prop.count=frequency/total.count*100) %>% "
"0","  select(-c(frequency, total.count))"
"0",""
"0","# Add author information to each data frame."
"0","blx <- blx %>% mutate(author='bloxton')"
"0","thr <- thr %>% mutate(author='thraikill')"
"0","#eth <- eth %>% mutate(author='ethier')"
"0",""
"0","# Join the two frames together."
"0","rv <- bind_rows(blx, thr)"
"0",""
"0","# Add mass."
"0","# rv <- left_join(rv, prey.list) %>% mutate_if(is.character, replace_na, 'Unknown') %>% "
"0","#   left_join(mean.mass) %>% "
"0","#   mutate(mass=coalesce(mass, average)) %>% "
"0","#   select(author, class, family, order, genus, species, binomial, common, category, prop.count, mass)"
"0",""
"0","# Calculate biomass."
"0","#rv <- rv %>% mutate(biomass=prop.count*mass)"
"0",""
"0","# Calculate counts from my own data."
"0","# prop.count.avian.pr <- filter(diet.items, source != 'C') %>% "
"0","#   mutate(total=n()) %>% filter(class == 'Aves') %>% "
"0","#   mutate(count=n(), to.count=count/total*100) %>% "
"0","#   distinct(to.count) %>% as.numeric()"
"0","# "
"0","# prop.count.mammal.pr <- filter(diet.items, source != 'C') %>% "
"0","#   mutate(total=n()) %>% filter(class == 'Mammalia') %>% "
"0","#   mutate(count=n(), to.count=count/total*100) %>% "
"0","#   distinct(to.count) %>% as.numeric()"
"0",""
"0","# Add in new data."
"0","mn <- tribble("
"0","  ~author, ~class, ~proportion,"
"0","  'case', 'Aves', 60.55,"
"0","  'case', 'Mammalia', 39.45,"
"0","  'watson', 'Aves', 53,"
"0","  'watson', 'Mammalia', 47,"
"0","  'lewis', 'Aves', 83.65,"
"0","  'lewis', 'Mammalia', 16.35"
"0",")"
"0",""
"0","# This is combined pellets-and-remains, for my own data as well as Watson's."
"0",""
"0","# Join with Bloxton & Thraikill."
"0","pnw.class.summary <- rv %>% group_by(author, class) %>% "
"0","  mutate(proportion=sum(prop.count)) %>% "
"0","  distinct(author, class, proportion) %>% "
"0","  bind_rows(mn) %>% "
"0","  pivot_wider(names_from=class, values_from=proportion) %>% "
"0","  arrange(Aves)"
"0",""
"0","# For squirrels, also."
"0","# prop.count.squirrel.pr <- filter(diet.items, source != 'C') %>% "
"0","#   mutate(total=n()) %>% filter(group == 'squirrel') %>% "
"0","#   mutate(count=n(), to.count=count/total*100) %>% "
"0","#   distinct(to.count) %>% as.numeric()"
"0",""
"0","mn.sq <- tribble("
"0","  ~author, ~genus, ~prop.count,"
"0","  'case', 'Tamiasciurus', 24.22,"
"0","  'watson', 'Tamiasciurus', 15.1,"
"0",")"
"0",""
"0","pnw.squirrel.summary <- rv %>% filter(common %in% c('douglas squirrel', 'red squirrel')) %>% "
"0","  select(genus=common, prop.count, author) %>%"
"0","  bind_rows(mn.sq) %>% "
"0","  arrange(prop.count)"
