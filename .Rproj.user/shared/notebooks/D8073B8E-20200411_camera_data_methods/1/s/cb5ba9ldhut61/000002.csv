"0","# Number (count) of deliveries per day."
"0","del.per.day <- df %>% filter(interest %in% c('delivery', 'newprey')) %>% "
"0","  mutate(day=date(datetime)) %>% "
"0","  group_by(site) %>% "
"0","  mutate(first=min(day), last=max(day), n.day=last-first) %>% "
"0","  add_count(site, day, name='n.del') %>% "
"0","  add_count(site, name='t.del') %>% "
"0","  mutate(n.day=as.numeric(n.day), per.day=t.del/n.day) %>% "
"0","  dplyr::select(site, day, n.day, n.del, t.del) %>% "
"0","  distinct() %>% "
"0","  complete(nesting(site), day=seq(min(day), max(day), by='day')) %>% "
"0","  fill(n.day, t.del) %>% "
"0","  mutate(n.del=replace_na(n.del, 0))"
"0","source('../src/prey_attributes_date.R')"
"0","# Amount (biomass) of deliveries per day."
"0","mass.by.day <- items.alt %>% mutate(date=date(datetime)) %>% "
"0","  group_by(site, date) %>% "
"0","  mutate(d.mass=sum(mass)) %>% "
"0","  dplyr::select(site, date, d.mass) %>% "
"0","  arrange(site, date) %>% "
"0","  distinct() %>% "
"0","  ungroup() %>% group_by(site) %>% "
"0","  complete(nesting(site), date=seq(min(date), max(date), by='day')) %>% "
"0","  mutate(d.mass=replace_na(d.mass, 0))"
"0","# Import nest data."
"0","nests <- read.csv('../data/raw/camera_nests_2019.csv', stringsAsFactors=FALSE)"
"0","# Do the datetime thing."
"0","nests <- nests %>% mutate(est_hatch=ymd(est_hatch))"
"0","# Table with date and age for each site."
"0","age <- nests %>% dplyr::select(site, est_hatch) %>% "
"0","  mutate(fledge=est_hatch + 99) %>% "
"0","  pivot_longer(cols=2:3) %>% "
"0","  group_by(site) %>% "
"0","  complete(nesting(site), value=seq(min(value), max(value), by='day')) %>% "
"0","  mutate(age=seq(1:100), date=value) %>% "
"0","  dplyr::select(site, date, age)"
"0","# Re-digest mass data into model-friendly format."
"0","mass.for.model <- items.alt %>% mutate(date=date(datetime)) %>% "
"0","  group_by(site, date) %>% "
"0","  mutate(d.mass=sum(mass), log.d.mass=log(d.mass)) %>% "
"0","  pivot_wider(names_from=class, values_from=mass, values_fill=list(mass=0)) %>% "
"0","  mutate(Aves=sum(Aves), Mammalia=sum(Mammalia), Unknown=sum(Unknown)) %>% "
"0","  arrange(site, date) %>% "
"0","  dplyr::select(site, date, Aves, Mammalia, Unknown, d.mass, log.d.mass) %>% "
"0","  distinct() %>% "
"0","  mutate(p.mammal=Mammalia/d.mass)"
"0","# Now graft them together."
"0","mass.for.model <- left_join(mass.for.model, age) %>% "
"0","  mutate(age=as.numeric(age))"
"0","# And make a model."
"0","m.mass.by.age <- lm(log.d.mass ~ age, data=mass.for.model)"
