"0","# Calculate diet diversity."
"0","diet.diversity <- plyr::ddply(diet.wide, ~nest, function(x) {"
"0","           data.frame(diet.diversity=diversity(x[-1], index='simpson'))"
"0","   })"
"0",""
"0","# Calculate diet richness"
"0","# Can't seem to calculate this right now, given my sample size."
"0","# Can do n spp just for something to do."
"0","diet.richness <- diet.items %>% filter(genus != 'Unknown') %>% "
"0","  select(nest, binomial) %>% "
"0","  distinct() %>% "
"0","  group_by(nest) %>% "
"0","  summarize(n=n())"
"0",""
"0","# Calculate diet evenness"
"0","diet.evenness <- plyr::ddply(diet.wide, ~nest, function(x) {"
"0","  data.frame(diet.evenness=diversity(x[-1], index='simpson')/log(sum(x[-1]>0)))"
"0","})"
"0",""
"0","# Proportion of diet made up of squirrel, by biomass."
"0","proportion.squirrel <-diet.items %>% mutate(mass=as.numeric(mass)) %>% "
"0","  group_by(nest) %>% "
"0","  mutate(total=sum(mass)) %>% "
"0","  filter(genus == 'Tamiasciurus') %>% "
"0","  mutate(amount.sq=sum(mass), proportion.squirrel=amount.sq/total) %>% "
"0","  select(nest, proportion.squirrel) %>% distinct()"
"0",""
"0","# Proportion of diet made up of mammal, by biomass."
"0","proportion.mammal <-diet.items %>% mutate(mass=as.numeric(mass)) %>% "
"0","  group_by(nest) %>% "
"0","  mutate(total=sum(mass)) %>% "
"0","  filter(class == 'Mammalia') %>% "
"0","  mutate(amount.mm=sum(mass), proportion.mammal=amount.mm/total) %>% "
"0","  select(nest, proportion.mammal) %>% distinct()"
"0",""
"0","# Proportion of diet made up of bird, by biomass."
"0","proportion.bird <-diet.items %>% mutate(mass=as.numeric(mass)) %>% "
"0","  group_by(nest) %>% "
"0","  mutate(total=sum(mass)) %>% "
"0","  filter(class == 'Aves') %>% "
"0","  mutate(amount.av=sum(mass), proportion.bird=amount.av/total) %>% "
"0","  select(nest, proportion.bird) %>% distinct()"
"0",""
"0","# Join together."
"0","diet.variables <- full_join(diet.diversity, proportion.squirrel) %>% "
"0","  full_join(proportion.mammal) %>% "
"0","  full_join(proportion.bird) %>% "
"0","  #full_join(diet.richness) %>% "
"0","  full_join(diet.evenness)"
"0",""
"0","diet.variables %>% pivot_longer(-nest, names_to='variable', values_to='value') %>% "
"0","  ggplot(aes(x=variable, y=value, fill=variable)) + "
"0","  geom_boxplot() +"
"0","  geom_jitter() +"
"0","  scale_fill_brewer(palette='Set2') +"
"0","  theme_classic()"
