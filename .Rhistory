# Calculate standard deviation of thrush biomass per nest.
sd.thrush.biomass.nest <- filter(diet.items, source == 'C') %>% group_by(nest) %>%
mutate(total=sum(mass)) %>% filter(group == 'thrush') %>%
mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(nest, to.mass) %>%
ungroup() %>% summarize(sd(to.mass)) %>% peretty(0)
# Mean nest diversity.
mean.nest.diversity <- mean(nest.diversity$diet.diversity) %>% round(2)
# Standard deviation of nest diversity.
sd.nest.diversity <- sd(nest.diversity$diet.diversity) %>% round(2)
# Mean nest overlap.
mean.nest.overlap <- mean(nest.overlap$value) %>% round(2)
# Standard deviation of nest overlap.
sd.nest.overlap <- sd(nest.overlap$value) %>% round(2)
# Number of transition zone sites.
n.tz.cam.sites <- left_join(diet.items, centroids.sf, by=c('site')) %>%
filter(zone == 'tz' & source == 'C') %>% distinct(nest) %>%
summarize(n()) %>% as.numeric()
# Number of coastal zone sites.
n.cs.cam.sites <- left_join(diet.items, centroids.sf, by=c('site')) %>%
filter(zone == 'cs' & source == 'C') %>% distinct(nest) %>%
summarize(n()) %>% as.numeric()
### Comparison of mammals between zones.
# Mean proportion mammalian biomass in transition zone.
percent.mammal.biomass.tz <- left_join(diet.items, centroids.sf, by=c('site')) %>%
filter(zone == 'tz' & source == 'C') %>% group_by(nest) %>%
mutate(total=sum(mass)) %>% filter(class == 'Mammalia') %>%
mutate(mmass=sum(mass), cmass=mmass/total*100) %>%
distinct(nest, cmass) %>% ungroup() %>% summarize(mean(cmass)) %>% peretty(0)
# Mean proportion mammalian biomass in coastal zone.
percent.mammal.biomass.cs <- left_join(diet.items, centroids.sf, by=c('site')) %>%
filter(zone == 'cs' & source == 'C') %>% group_by(nest) %>%
mutate(total=sum(mass)) %>% filter(class == 'Mammalia') %>%
mutate(mmass=sum(mass), cmass=mmass/total*100) %>%
distinct(nest, cmass) %>% ungroup() %>% summarize(mean(cmass)) %>% peretty(0)
# Percent mammalian biomass per nest, by zone.
percent.mammal.biomass.zone.nest <- left_join(diet.items, centroids.sf, by=c('site')) %>%
filter(source == 'C') %>% group_by(nest) %>%
mutate(total=sum(mass)) %>% filter(class == 'Mammalia') %>%
mutate(mmass=sum(mass), cmass=mmass/total) %>%
distinct(zone, nest, cmass)
# P-value for unpaired two-sample t-test for mammal biomass between zones.
p.value.mammal.biomass.zone <- t.test(cmass ~ zone,
data=percent.mammal.biomass.zone.nest, var.equal=TRUE) %>%
glance() %>% select(p.value) %>% peretty()
### Comparison of squirrels between zones.
# Mean proportion squirrel biomass in transition zone.
percent.squirrel.biomass.tz <- left_join(diet.items, centroids.sf, by=c('site')) %>%
filter(zone == 'tz' & source == 'C') %>% group_by(nest) %>%
mutate(total=sum(mass)) %>% filter(genus == 'Tamiasciurus') %>%
mutate(mmass=sum(mass), cmass=mmass/total*100) %>%
distinct(nest, cmass) %>% ungroup() %>% summarize(mean(cmass)) %>% peretty(0)
# Mean proportion squirrel biomass in coastal zone.
percent.squirrel.biomass.cs <- left_join(diet.items, centroids.sf, by=c('site')) %>%
filter(zone == 'cs' & source == 'C') %>% group_by(nest) %>%
mutate(total=sum(mass)) %>% filter(genus == 'Tamiasciurus') %>%
mutate(mmass=sum(mass), cmass=mmass/total*100) %>%
distinct(nest, cmass) %>% ungroup() %>% summarize(mean(cmass)) %>% peretty(0)
# Percent squirrel biomass per nest, by zone.
percent.squirrel.biomass.zone.nest <- left_join(diet.items, centroids.sf, by=c('site')) %>%
filter(source == 'C') %>% group_by(nest) %>%
mutate(total=sum(mass)) %>% filter(genus == 'Tamiasciurus') %>%
mutate(mmass=sum(mass), cmass=mmass/total) %>%
distinct(zone, nest, cmass)
# P-value for unpaired two-sample t-test for squirrel biomass between zones.
p.value.squirrel.biomass.zone <- t.test(cmass ~ zone,
data=percent.squirrel.biomass.zone.nest, var.equal=TRUE) %>%
glance() %>% select(p.value) %>% peretty()
# Test statistic for pellet data chi-squared test.
x.stat.pellet <- zone.chi %>% filter(source == 'P') %>% unnest(gl) %>% ungroup() %>%
select(statistic) %>% peretty()
# P value for pellet data chi-squared test.
p.value.pellet <- zone.chi %>% filter(source == 'P') %>% unnest(gl) %>% ungroup() %>%
select(p.value) %>% peretty()
# Test statistic for combined pellets-and-remains data chi-squared test.
x.stat.rp <- zone.chi %>% filter(source == 'RP') %>% unnest(gl) %>% ungroup() %>%
select(statistic) %>% peretty()
# P value for combined pellet-and-remains data chi-squared test.
p.value.rp <- zone.chi %>% filter(source == 'RP') %>% unnest(gl) %>% ungroup() %>%
select(p.value) %>% peretty()
# Test statistic for camera data chi-squared test.
x.stat.camera <- zone.chi %>% filter(source == 'C') %>% unnest(gl) %>% ungroup() %>%
select(statistic) %>% peretty()
# P value for camera data chi-squared test.
p.value.camera <- zone.chi %>% filter(source == 'C') %>% unnest(gl) %>% ungroup() %>%
select(p.value) %>% peretty()
# Calculate productivity for each nest by zone.
productivity.zone <- left_join(productivity, centroids.sf, by=c('site', 'name')) %>%
select(site, year, n.fledge, zone) %>%
mutate(nest=paste0(site, year))
p.value.productivity.zone <- t.test(n.fledge ~ zone, data=productivity.zone) %>% glance() %>%
select(p.value) %>% peretty()
diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial'))
diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(class, common, binomial, C, C2, P, P2, R, R2)
diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(class, common, binomial, C, C2, P, P2, R, R2) %>%
mutate(common=replace_na(., 'Unknown'))
diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(class, common, binomial, C, C2, P, P2, R, R2) %>%
mutate(common=replace_na(common, 'Unknown'))
diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(class, common, binomial, C, C2, P, P2, R, R2) %>%
mutate(common=replace_na(common, 'Unknown'),
binomial=replace(binomial, 'Unidentified item', 'NA'))
temp <- diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(class, common, binomial, C, C2, P, P2, R, R2) %>%
mutate(common=replace_na(common, 'Unknown'))
temp %>% mutate(binomial=str_replace(binomial, 'Unidentified item', 'NA'))
temp %>% mutate(binomial=str_replace(binomial, 'Unidentified item', NA))
temp %>% mutate(binomial=str_replace(binomial, 'Unidentified item', NA_character_))
view(temp)
temp <- diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(class, common, binomial, C, C2, P, P2, R, R2) %>%
mutate(common=replace_na(common, 'Unknown'),
binomial=str_replace(binomial, 'Unidentified item', NA_character_))
view(temp)
temp <- diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(class, common, binomial, C, C2, P, P2, R, R2) %>%
mutate(common=replace_na(common, 'unknown'),
binomial=str_replace(binomial, 'Unidentified item', NA_character_))
view(temp)
temp %>% str_to_tite(common, locale='en')
library(stringr)
temp %>% str_to_tite(common, locale='en')
temp %>% str_to_title(common, locale='en')
str_to_title(temp$common)
str_to_sentence(temp$common)
temp %>% str_to_title(common, locale='en')
temp %>% str_to_title(.$common, locale='en')
temp %>% str_to_title(locale='en')
temp %>% mutate(common=str_to_title(locale='en'))
temp %>% mutate(common=str_to_title(common, locale='en'))
temp %>% mutate(common=str_to_title(common, locale='en')) %>% view()
temp %>% mutate(common=str_to_sentence(common, locale='en')) %>% view()
temp <- diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(class, common, binomial, C, C2, P, P2, R, R2) %>%
mutate(common=replace_na(common, 'unknown'),
binomial=str_replace(binomial, 'Unidentified item', NA_character_),
common=str_to_sentence(common, locale='en'))
diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(class, common, binomial, C, C2, P, P2, R, R2) %>%
mutate(common=replace_na(common, 'unknown'),
binomial=str_replace(binomial, 'Unidentified item', NA_character_),
common=str_to_sentence(common, locale='en')) %>%
kable(digits=1) %>%
kable_styling(bootstrap_options=c('striped'))
diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(class, common, binomial, C, C2, P, P2, R, R2) %>%
mutate(common=replace_na(common, 'unknown'),
binomial=str_replace(binomial, 'Unidentified item', NA_character_),
common=str_to_sentence(common, locale='en')) %>%
kable(digits=1) %>%
kable_styling(bootstrap_options=c('striped')) %>%
add_header_above(c(''=3, 'Camera'=2, 'Pellets'=2, 'Remains'=2))
diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(class, common, binomial, C, C2, P, P2, R, R2) %>%
mutate(common=replace_na(common, 'unknown'),
binomial=str_replace(binomial, 'Unidentified item', NA_character_),
common=str_to_sentence(common, locale='en')) %>%
kable(digits=1) %>%
kable_styling(bootstrap_options=c('striped')) %>%
add_header_above(c(' '=3, 'Camera'=2, 'Pellets'=2, 'Remains'=2))
diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(class, common, binomial, C, C2, P, P2, R, R2) %>%
mutate(common=replace_na(common, 'unknown'),
binomial=str_replace(binomial, 'Unidentified item', NA_character_),
common=str_to_sentence(common, locale='en')) %>%
kable(digits=1) %>%
kable_styling(bootstrap_options=c('striped')) %>%
add_header_above(c(' '=1, 'Species'=2, 'Camera'=2, 'Pellets'=2, 'Remains'=2))
diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(Class=class, common=common, binomial=binomial, C, C2, P, P2, R, R2) %>%
mutate(common=replace_na(common, 'unknown'),
binomial=str_replace(binomial, 'Unidentified item', NA_character_),
common=str_to_sentence(common, locale='en')) %>%
kable(digits=1) %>%
kable_styling(bootstrap_options=c('striped')) %>%
add_header_above(c(' '=1, 'Species'=2, 'Camera'=2, 'Pellets'=2, 'Remains'=2))
diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(Class=class, common=common, binomial=binomial, `per biomass`=C, C2, P, P2, R, R2) %>%
mutate(common=replace_na(common, 'unknown'),
binomial=str_replace(binomial, 'Unidentified item', NA_character_),
common=str_to_sentence(common, locale='en')) %>%
kable(digits=1) %>%
kable_styling(bootstrap_options=c('striped')) %>%
add_header_above(c(' '=1, 'Species'=2, 'Camera'=2, 'Pellets'=2, 'Remains'=2))
diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(Class=class, common=common, binomial=binomial, `\% count`=C, C2, P, P2, R, R2) %>%
biomass.table <- diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(class, common, binomial, C, C2, P, P2, R, R2) %>%
mutate(common=replace_na(common, 'unknown'),
binomial=str_replace(binomial, 'Unidentified item', NA_character_),
common=str_to_sentence(common, locale='en'))
biomass.table %>%
kable(digits=1, col.names=c('Class', 'common', 'binomial', 'count',
'pi', 'pb', 'pi', 'pb', 'pi', 'pb')) %>%
kable_styling(bootstrap_options=c('striped')) %>%
add_header_above(c(' '=1, 'Species'=2, 'Camera'=2, 'Pellets'=2, 'Remains'=2))
biomass.table <- diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(class, common, binomial, count, C, C2, P, P2, R, R2) %>%
mutate(common=replace_na(common, 'unknown'),
binomial=str_replace(binomial, 'Unidentified item', NA_character_),
common=str_to_sentence(common, locale='en'))
biomass.table %>%
kable(digits=1, col.names=c('Class', 'common', 'binomial', 'count',
'pi', 'pb', 'pi', 'pb', 'pi', 'pb')) %>%
kable_styling(bootstrap_options=c('striped')) %>%
add_header_above(c(' '=1, 'Species'=2, 'Camera'=2, 'Pellets'=2, 'Remains'=2))
biomass.table %>%
kable(digits=1, col.names=c('Class', 'common', 'binomial', 'count',
'pi', 'pb', 'pi', 'pb', 'pi', 'pb')) %>%
kable_styling(bootstrap_options=c('striped')) %>%
add_header_above(c(' '=1, 'Species'=2, ''=1, 'Camera'=2, 'Pellets'=2, 'Remains'=2))
biomass.table %>%
kable(digits=1, col.names=c('Class', 'common', 'binomial', 'count',
'pi', 'pb', 'pi', 'pb', 'pi', 'pb')) %>%
kable_styling(bootstrap_options=c('striped')) %>%
add_header_above(c(' '=1, 'Species'=2, ' '=1, 'Camera'=2, 'Pellets'=2, 'Remains'=2))
biomass.table %>%
kable(digits=1, col.names=c('Class', 'common', 'binomial', 'N',
'% items', 'pb', 'pi', 'pb', 'pi', 'pb')) %>%
kable_styling(bootstrap_options=c('striped')) %>%
add_header_above(c(' '=1, 'Species'=2, ' '=1, 'Camera'=2, 'Pellets'=2, 'Remains'=2))
biomass.table %>%
kable(digits=1, col.names=c('Class', 'common', 'binomial', 'N',
'% items', '% biomass',
'% items', '% biomass',
'% items', '% biomass')) %>%
kable_styling(bootstrap_options=c('striped')) %>%
add_header_above(c(' '=1, 'Species'=2, ' '=1, 'Camera'=2, 'Pellets'=2, 'Remains'=2))
biomass.table %>%
kable(digits=1, col.names=c('Class', ' ', ' ', 'N',
'% items', '% biomass',
'% items', '% biomass',
'% items', '% biomass')) %>%
kable_styling(bootstrap_options=c('striped')) %>%
add_header_above(c(' '=1, 'Species'=2, ' '=1, 'Camera'=2, 'Pellets'=2, 'Remains'=2))
biomass.table %>%
kable(digits=1, col.names=c('Class', 'Species', ' ', 'N',
'% items', '% biomass',
'% items', '% biomass',
'% items', '% biomass')) %>%
kable_styling(bootstrap_options=c('striped')) %>%
add_header_above(c(' '=4, 'Camera'=2, 'Pellets'=2, 'Remains'=2))
biomass.table <- diet.items %>% group_by(class, binomial) %>% mutate(count=n()) %>% ungroup() %>%
group_by(source) %>% mutate(total.source.count=n(),
total.source.mass=sum(mass)) %>% ungroup() %>%
group_by(source, class, binomial) %>% mutate(source.count=n(),
source.mass=sum(mass),
per.source.count=source.count/total.source.count*100,
per.source.mass=source.mass/total.source.mass*100) %>%
distinct(source, class, binomial, count, per.source.count, per.source.mass) %>%
mutate(source2=paste0(source, '2')) %>%
pivot_wider(names_from=source, values_from=per.source.count) %>%
pivot_wider(names_from=source2, values_from=per.source.mass) %>% ungroup() %>%
group_by(class, binomial) %>%
fill(everything(), .direction='downup') %>%
distinct() %>% left_join(prey.list, by=c('class', 'binomial')) %>%
select(class, common, binomial, count, C, C2, P, P2, R, R2) %>%
mutate(common=replace_na(common, 'unknown'),
binomial=str_replace(binomial, 'Unidentified item', NA_character_),
common=str_to_sentence(common, locale='en')) %>%
arrange(class, binomial)
biomass.table %>%
kable(digits=1, col.names=c('Class', 'Species', ' ', 'N',
'% items', '% biomass',
'% items', '% biomass',
'% items', '% biomass')) %>%
kable_styling(bootstrap_options=c('striped')) %>%
add_header_above(c(' '=4, 'Camera'=2, 'Pellets'=2, 'Remains'=2))
biomass.table %>%
kable(digits=1, col.names=c('Class', 'Species', ' ', 'N',
'% items', '% biomass',
'% items', '% biomass',
'% items', '% biomass')) %>%
kable_styling(bootstrap_options=c('striped')) %>%
column_spec(3, italic=TRUE) %>%
add_header_above(c(' '=4, 'Camera'=2, 'Pellets'=2, 'Remains'=2))
