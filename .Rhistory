facet_wrap(vars(site))
ggplot(df2, aes(x=day)) +
geom_histogram(binwidth=1, color='black', fill='gray') +
theme_classic() +
facet_wrap(vars(site))
ggplot(df2, aes(x=day)) +
geom_histogram(binwidth=1, color='black', fill='gray') +
theme_classic() +
facet_wrap(vars(site))
ggplot(df, aes(x=day)) +
geom_histogram(binwidth=1, color='black', fill='gray') +
theme_classic() +
facet_wrap(vars(site))
df %>% mutate(day=yday(datetime)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
ggplot(aes(x=day)) +
geom_histogram(binwidth=1, color='black', fill='gray') +
theme_classic() +
facet_wrap(vars(site))
df2 <- df %>% group_by(site, interest) %>%
summarize(n())
df %>% mutate(day=yday(datetime)) %>%
group_by(site, day) %>%
summarize(n())
df %>% mutate(day=yday(datetime)) %>%
group_by(site, day) %>%
summarize(n=n())
df2 <- df %>% mutate(day=yday(datetime)) %>%
group_by(site, day) %>%
summarize(n=n())
df2 <- df %>% mutate(day=yday(datetime)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, day) %>%
summarize(n=n())
View(df2)
df2 <- df %>% mutate(day=yday(datetime), site=as.factor(site)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, day) %>%
summarize(n=n())
ggplot(df2, aes(x=day, y=count)) +
geom_boxplot()
ggplot(df2, aes(x=day, y=n)) +
geom_boxplot()
df2 <- df %>% mutate(day=yday(datetime), day=as.factor(day)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, day) %>%
summarize(n=n())
ggplot(df2, aes(x=day, y=n)) +
geom_boxplot()
ggplot(df2, aes(x=day, y=n)) +
geom_boxplot() +
theme_classic() +
facet_wrap(vars(site))
df2 <- df %>% mutate(day=yday(datetime), site=as.factor(site)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, day) %>%
summarize(n=n())
ggplot(df2, aes(x=site, y=n)) +
geom_boxplot() +
theme_classic() +
facet_wrap(vars(site))
ggplot(df2, aes(x=site, y=n)) +
geom_boxplot() +
theme_classic()
df %>% mutate(day=yday(datetime), site=as.factor(site)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, day) %>%
summarize(n=n()) %>%
ggplot(aes(x=site, y=n)) +
geom_boxplot() +
theme_classic()
df %>% mutate(day=yday(datetime), site=as.factor(site)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, day) %>%
summarize(n=n()) %>%
ggplot(aes(x=site, y=n)) +
geom_boxplot() +
theme_classic()
df %>% mutate(day=yday(datetime), site=as.factor(site)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, day) %>%
summarize(n=n()) %>%
ggplot(aes(x=site, y=n)) +
geom_boxplot() +
theme_classic()
df %>% filter(interest %in% c('delivery', 'newprey')) %>%
mutate(day=yday(datetime), hour=hour(datetime))
df2 <- df %>% filter(interest %in% c('delivery', 'newprey')) %>%
mutate(day=yday(datetime), hour=hour(datetime))
ggplot(df2, aes(x=hour, color=day)) +
geom_freqpoly(binwidth=1) +
facet_wrap(vars(site))
df2 <- df %>% filter(interest %in% c('delivery', 'newprey')) %>%
mutate(day=yday(datetime), day=as.factor(day), hour=hour(datetime))
ggplot(df2, aes(x=hour, color=day)) +
geom_freqpoly(binwidth=1) +
theme_classic()
ggplot(df2, aes(x=hour, color=day)) +
geom_freqpoly(binwidth=1) +
theme_classic() +
facet_wrap(vars(site))
df %>% mutate(hour=hour(datetime), site=as.factor(site)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, hour) %>%
summarize(n=n())
df %>% mutate(hour=hour(datetime), site=as.factor(site)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, hour) %>%
summarize(n=n()) %>%
ggplot(aes(x=site, y=n)) +
geom_boxplot() +
theme_classic()
df %>% mutate(hour=hour(datetime), site=as.factor(site)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, hour) %>%
summarize(n=n()) %>%
ggplot(aes(x=site, y=n)) +
geom_boxplot() +
theme_classic()
df %>% mutate(hour=hour(datetime), site=as.factor(site)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, hour) %>%
summarize(n=n()) %>%
ggplot(aes(x=site, y=n)) +
geom_boxplot() +
theme_classic()
df %>% mutate(hour=hour(datetime), site=as.factor(site)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
ggplot(aes(x=hour(datetime))) +
geom_histogram() +
theme_classic() +
facet_wrap(vars(site))
df %>% mutate(hour=hour(datetime), site=as.factor(site)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
ggplot(aes(x=hour(datetime))) +
geom_histogram(binwidth=1, color='black', fill='gray') +
theme_classic() +
facet_wrap(vars(site))
df %>% mutate(hour=hour(datetime), site=as.factor(site)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
ggplot(aes(x=hour(datetime))) +
geom_histogram(binwidth=1, color='black', fill='gray') +
theme_classic() +
facet_wrap(vars(site))
df %>% mutate(hour=hour(datetime), site=as.factor(site)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
ggplot(aes(x=hour(datetime))) +
geom_histogram(binwidth=1, color='black', fill='gray') +
theme_classic() +
facet_wrap(vars(site))
library('RColorBrewer')
df %>% filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, class, family) %>%
summarize(n=n())
df %>% filter(class != '') %>%
group_by(site, class, family) %>%
summarize(n=n())
df2 <- df %>% filter(class != '') %>%
group_by(site, class, family) %>%
summarize(n=n())
ggplot(df2, aes(fill=family, y=n, x=class)) +
geom_bar(position='stack', stat='identity') +
scale_fill_brewer(palette='BrBG') +
theme_classic() +
acet_wrap(vars(site))
ggplot(df2, aes(fill=family, y=n, x=class)) +
geom_bar(position='stack', stat='identity') +
scale_fill_brewer(palette='BrBG') +
theme_classic() +
facet_wrap(vars(site))
ggplot(df2, aes(fill=family, y=n, x=class)) +
geom_bar(position='stack', stat='identity') +
theme_classic() +
facet_wrap(vars(site))
library('viridis')
ggplot(df2, aes(fill=family, y=n, x=class)) +
geom_bar(position='stack', stat='identity') +
scale_color_viridis() +
theme_classic() +
facet_wrap(vars(site))
ggplot(df2, aes(fill=family, y=n, x=class)) +
geom_bar(position='stack', stat='identity') +
scale_color_viridis(discrete=TRUE) +
theme_classic() +
facet_wrap(vars(site))
ggplot(df2, aes(fill=family, y=n, x=class)) +
geom_bar(position='stack', stat='identity') +
scale_fill_viridis() +
theme_classic() +
facet_wrap(vars(site))
library('viridis')
ggplot(df2, aes(fill=family, y=n, x=class)) +
geom_bar(position='stack', stat='identity') +
scale_fill_viridis(discrete=TRUE) +
theme_classic() +
facet_wrap(vars(site))
knitr::opts_chunk$set(echo=TRUE, message=FALSE, warning=FALSE)
# Load up some libraries.
library('tidyverse')
library('lubridate')
library('ggplot2')
library('knitr')
library('kableExtra')
# Import the data.
df <- read.csv('../data/interim/camera_data.csv', stringsAsFactors=FALSE)
df <- df %>% mutate(datetime=parse_date_time(datetime,
orders=c('%Y-%m-%d %H:%M:%S', '%Y/%m/%d %H:%M:%S')))
df %>% mutate(day=yday(datetime)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
ggplot(aes(x=day)) +
geom_histogram(binwidth=1, color='black', fill='gray') +
theme_classic() +
facet_wrap(vars(site))
df %>% mutate(day=yday(datetime), site=as.factor(site)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, day) %>%
summarize(n=n()) %>%
ggplot(aes(x=site, y=n)) +
geom_boxplot() +
theme_classic()
df %>% mutate(hour=hour(datetime), site=as.factor(site)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, hour) %>%
summarize(n=n()) %>%
ggplot(aes(x=site, y=n)) +
geom_boxplot() +
theme_classic()
df %>% mutate(hour=hour(datetime), site=as.factor(site)) %>%
filter(interest %in% c('delivery', 'newprey')) %>%
ggplot(aes(x=hour(datetime))) +
geom_histogram(binwidth=1, color='black', fill='gray') +
theme_classic() +
facet_wrap(vars(site))
df %>% group_by(site, day(datetime))
df %>% group_by(site, day(datetime)) %>%
summarize(n=n())
df %>% group_by(site, ydayday(datetime)) %>%
summarize(n=n())
df %>% group_by(site, yday(datetime)) %>%
summarize(n=n())
df %>% group_by(site, yday(datetime), interest) %>%
summarize(n=n())
df %>% group_by(site, yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n)
df2 <- df %>% group_by(site, yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n)
View(df2)
df2 <- df %>% group_by(site, day=yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n)
df2 <- df %>% group_by(site, day=yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n) %>%
dplyr::select(site, day, newprey, delivery)
df2 <- df %>% group_by(site, day=yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n)
df2[1]
df2[ ,1]
df2[1, ]
df2[1, 3:9]
sum(df2[1, 3:9])
df2 <- df %>% group_by(site, day=yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n) %>%
mutate_at(c('cool','delivery','fledge','newprey', 'prey', 'visit'), replace_na, 0)
sum(df2[1, 3:9])
df2 <- df %>% group_by(site, day=yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n) %>%
mutate_at(c('cool','delivery','fledge','newprey', 'prey', 'visit'),
replace_na, 0) %>%
mutate(total=sum(3:9))
df2 <- df %>% group_by(site, day=yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n) %>%
replace(is.na(.), 0) %>%
mutate(total=rowSums(.[3:9]))
df2 <- df %>% group_by(site, day=yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n) %>%
replace(is.na(.), 0)
df2 <- df %>% group_by(site, day=yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n) %>%
replace(is.na(.), 0) %>%
mutate(total=rowSums(.[3:9]))
df2 <- df %>% group_by(site, day=yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n) %>%
replace(is.na(.), 0) %>%
mutate(total=rowSums(.[ ,3:9]))
df2 <- df %>% group_by(site, day=yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n) %>%
replace(is.na(.), 0) %>%
mutate(total=rowSums(.[3:9, ]))
class(df2$cool)
class(df2$delivery)
class(df2$newprey)
class(df2$prey)
class(df2$visit)
class(df2$fledge)
sum(df2[1, 3:9])
rowSums(df2[1, 3:9])
rowSums(df2[3:9])
rowSums(df2)
rowSums(df2[1, 3:9])
rowSums(df2[2, 3:9])
rowSums(df2[2, 4:9])
rowSums(df2[3, 3:9])
df2 <- df %>% group_by(site, day=yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n) %>%
replace(is.na(.), 0) %>%
mutate(total=rowSums(.[3:9]))
df2 <- df %>% group_by(site, day=yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n) %>%
replace(is.na(.), 0) %>%
mutate(total=rowSums([3:9]))
df2 <- df %>% group_by(site, day=yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n) %>%
replace(is.na(.), 0) %>%
mutate(total=rowSums(3:9))
df2 <- df %>% group_by(site, day=yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n) %>%
replace(is.na(.), 0) %>%
mutate(total=rowSums(.[,3:9]))
df2 <- df %>% group_by(site, day=yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n) %>%
replace(is.na(.), 0) %>%
mutate(total=rowSums([.,3:9]))
df2 <- df %>% group_by(site, day=yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n) %>%
replace(is.na(.), 0) %>%
mutate(sum = rowSums(.[,-1:2]))
df2 <- df %>% group_by(site, day=yday(datetime), interest) %>%
summarize(n=n()) %>%
spread(interest, n) %>%
replace(is.na(.), 0)
df2$total <- rowSums(df2)
df2$total <- rowSums(df2[, 3:9])
df %>% group_by(site, day=yday(datetime)) %>%
summarize(n=n())
df %>% filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, day=yday(datetime)) %>%
summarize(n.i=n())
df2 <- df %>% group_by(site, day=yday(datetime)) %>%
summarize(n=n())
df %>% filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, day=yday(datetime)) %>%
summarize(n.i=n()) %>%
bind_cols(df2)
df2 %>% filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, day=yday(datetime)) %>%
summarize(n.i=n())
df2 <- df %>% filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, day=yday(datetime)) %>%
summarize(n.i=n())
df3 <- df %>% group_by(site, day=yday(datetime)) %>%
summarize(n=n())
timespan <- df %>% filter(interest %in% c('delivery', 'newprey')) %>% group_by(site) %>%
summarize(first=min(datetime), last=max(datetime)) %>%
mutate(first=date(first), last=date(last)) %>%
mutate(days=difftime(last, first))
photos <- df %>% group_by(site) %>% summarize(photos=n())
View(photos)
bind_cols(timespan, photos)
bind_cols(timespan, photos) %>%
mutate(days=as.numeric(days))
bind_cols(timespan, photos) %>%
mutate(days=as.numeric(days), rate=photos/days)
success <- df %>% filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site, interest) %>%
summarize(n=n()) %>%
spread(interest, n) %>%
mutate(total=delivery+newprey, success=delivery/total*100)
bind_cols(timespan, photos, success) %>%
mutate(days=as.numeric(days), rate=photos/days)
check <- bind_cols(timespan, photos, success) %>%
mutate(days=as.numeric(days), rate=photos/days)
View(check)
View(success)
# Number of captures per site. ('total')
success <- df %>% filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site) %>%
summarize(n.prey=n())
# Number of captures per site. ('total')
captures <- df %>% filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site) %>%
summarize(n.prey=n(), f.prey=min(datetime), l.prey=max(datetime)) %>%
mutate(f.prey=date(f.prey), l.prey=date(l.prey)) %>%
mutate(d.prey=difftime(f.prey, l.prey))
View(captures)
# Total number of photos per site. ('photos')
photos <- df %>% group_by(site) %>%
summarize(n.photos=n(), f.photos=min(datetime), l.photos=max(datetime)) %>%
mutate(f.photos=date(f.photos), l.photos=date(l.photos)) %>%
mutate(d.photos=difftime(l.photos, f.photos))
View(photos)
# Total number of photos per site. ('photos')
photos <- df %>% group_by(site) %>%
summarize(n.photos=n(), f.photos=min(datetime), l.photos=max(datetime)) %>%
mutate(f.photos=date(f.photos), l.photos=date(l.photos)) %>%
mutate(d.photos=difftime(l.photos, f.photos))
bound <- bind_cols(photos, captures)
View(bound)
# Number of captures per site. ('total')
captures <- df %>% filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site) %>%
summarize(n.prey=n(), f.prey=min(datetime), l.prey=max(datetime)) %>%
mutate(f.prey=date(f.prey), l.prey=date(l.prey)) %>%
mutate(d.prey=difftime(f.prey, l.prey))
bound <- bind_cols(photos, captures)
View(bound)
# Number of captures per site. ('total')
captures <- df %>% filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site) %>%
summarize(n.prey=n(), f.prey=min(datetime), l.prey=max(datetime)) %>%
mutate(f.prey=date(f.prey), l.prey=date(l.prey)) %>%
mutate(d.prey=difftime(l.prey, f.prey))
bound <- bind_cols(photos, captures)
View(bound)
bound <- bind_cols(photos, captures) %>%
mutate(r.photos=n.photos/as.numeric(d.photos))
bound <- bind_cols(photos, captures) %>%
mutate(r.photos=n.photos/as.numeric(d.photos), r.prey=n.prey/as.numeric(d.photos))
bound <- bind_cols(photos, captures) %>%
mutate(r.photos=n.photos/as.numeric(d.photos), r.prey=n.prey/as.numeric(d.prey))
ggplot(bound, aes(x=r.photos, y=r.prey, label=site)) +
geom_point() +
geom_text(hjust='inward', nudge_y = 0.5) +
theme_classic()
# Calculate captures of prey per day.
captures <- df %>% filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site) %>%
summarize(n.prey=n(), f.prey=min(datetime), l.prey=max(datetime)) %>%
mutate(f.prey=date(f.prey), l.prey=date(l.prey)) %>%
mutate(d.prey=difftime(l.prey, f.prey))
# Calculate photos taken per day.
photos <- df %>% group_by(site) %>%
summarize(n.photos=n(), f.photos=min(datetime), l.photos=max(datetime)) %>%
mutate(f.photos=date(f.photos), l.photos=date(l.photos)) %>%
mutate(d.photos=difftime(l.photos, f.photos))
# Bind, calculate rates, and graph.
bound <- bind_cols(photos, captures) %>%
mutate(r.photos=n.photos/as.numeric(d.photos), r.prey=n.prey/as.numeric(d.prey)) %>%
ggplot(aes(x=r.photos, y=r.prey, label=site)) +
geom_point() +
geom_text(hjust='inward', nudge_y = 0.5) +
theme_classic()
# Calculate captures of prey per day.
captures <- df %>% filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site) %>%
summarize(n.prey=n(), f.prey=min(datetime), l.prey=max(datetime)) %>%
mutate(f.prey=date(f.prey), l.prey=date(l.prey)) %>%
mutate(d.prey=difftime(l.prey, f.prey))
# Calculate photos taken per day.
photos <- df %>% group_by(site) %>%
summarize(n.photos=n(), f.photos=min(datetime), l.photos=max(datetime)) %>%
mutate(f.photos=date(f.photos), l.photos=date(l.photos)) %>%
mutate(d.photos=difftime(l.photos, f.photos))
# Bind, calculate rates, and graph.
bound <- bind_cols(photos, captures) %>%
mutate(r.photos=n.photos/as.numeric(d.photos), r.prey=n.prey/as.numeric(d.prey)) %>%
ggplot(aes(x=r.photos, y=r.prey, label=site)) +
geom_point() +
geom_text(hjust='inward', nudge_y = 0.5) +
theme_classic()
# Calculate captures of prey per day.
captures <- df %>% filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site) %>%
summarize(n.prey=n(), f.prey=min(datetime), l.prey=max(datetime)) %>%
mutate(f.prey=date(f.prey), l.prey=date(l.prey)) %>%
mutate(d.prey=difftime(l.prey, f.prey))
# Calculate photos taken per day.
photos <- df %>% group_by(site) %>%
summarize(n.photos=n(), f.photos=min(datetime), l.photos=max(datetime)) %>%
mutate(f.photos=date(f.photos), l.photos=date(l.photos)) %>%
mutate(d.photos=difftime(l.photos, f.photos))
# Bind, calculate rates, and graph.
bound <- bind_cols(photos, captures) %>%
mutate(r.photos=n.photos/as.numeric(d.photos), r.prey=n.prey/as.numeric(d.prey)) %>%
ggplot(aes(x=r.photos, y=r.prey, label=site)) +
geom_point() +
geom_text(hjust='inward', nudge_y = 0.5) +
theme_classic()
# Calculate captures of prey per day.
captures <- df %>% filter(interest %in% c('delivery', 'newprey')) %>%
group_by(site) %>%
summarize(n.prey=n(), f.prey=min(datetime), l.prey=max(datetime)) %>%
mutate(f.prey=date(f.prey), l.prey=date(l.prey)) %>%
mutate(d.prey=difftime(l.prey, f.prey))
# Calculate photos taken per day.
photos <- df %>% group_by(site) %>%
summarize(n.photos=n(), f.photos=min(datetime), l.photos=max(datetime)) %>%
mutate(f.photos=date(f.photos), l.photos=date(l.photos)) %>%
mutate(d.photos=difftime(l.photos, f.photos))
# Bind, calculate rates, and graph.
bind_cols(photos, captures) %>%
mutate(r.photos=n.photos/as.numeric(d.photos), r.prey=n.prey/as.numeric(d.prey)) %>%
ggplot(aes(x=r.photos, y=r.prey, label=site)) +
geom_point() +
geom_text(hjust='inward', nudge_y = 0.5) +
theme_classic()
