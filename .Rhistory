# HSI contagion.
diet.diversity.by.hsi.contagion <- data %>%
drop_na(diet.diversity) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(diet.diversity ~ hsi.contagion, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='hsi contagion')
# Proportion suitable.
diet.diversity.by.proportion.suitable <- data %>%
drop_na(diet.diversity) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(diet.diversity ~ proportion.suitable, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='proportion suitable')
# Suitable habitat edge density.
diet.diversity.by.suitable.edge.density <- data %>%
drop_na(diet.diversity) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(diet.diversity ~ suitable.edge.density, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='suitable habitat edge density')
# Bind it all together.
statistics <- bind_rows(diet.diversity.by.bec.diversity,
diet.diversity.by.proportion.cover.mature,
diet.diversity.by.cover.edge.density,
diet.diversity.by.cover.contagion,
diet.diversity.by.cover.diversity,
diet.diversity.by.cover.evenness,
diet.diversity.by.cover.richness,
diet.diversity.by.hsi.edge.density,
diet.diversity.by.hsi.contagion,
diet.diversity.by.proportion.suitable,
diet.diversity.by.suitable.edge.density)
statistics <- statistics %>% mutate(sig=round(p.value, digits=2)) %>%
mutate(sig=case_when(
p.value < 0.1 ~ paste(as.character(sig), '*'),
TRUE ~  paste(as.character(sig))
))
statistics %>% select(size, sig, variable) %>%
pivot_wider(names_from=size, values_from=sig) %>%
select(variable, PFA, everything()) %>%
kable() %>% kable_styling(bootstrap_options=c('striped'))
# Bind it all together.
diet.diversity.statistics <- bind_rows(diet.diversity.by.bec.diversity,
diet.diversity.by.proportion.cover.mature,
diet.diversity.by.cover.edge.density,
diet.diversity.by.cover.contagion,
diet.diversity.by.cover.diversity,
diet.diversity.by.cover.evenness,
diet.diversity.by.cover.richness,
diet.diversity.by.hsi.edge.density,
diet.diversity.by.hsi.contagion,
diet.diversity.by.proportion.suitable,
diet.diversity.by.suitable.edge.density)
diet.diversity.statistics <- diet.diversity.statistics %>% mutate(sig=round(p.value, digits=2)) %>%
mutate(sig=case_when(
p.value < 0.1 ~ paste(as.character(sig), '*'),
TRUE ~  paste(as.character(sig))
))
diet.diversity.statistics %>% select(size, sig, variable) %>%
pivot_wider(names_from=size, values_from=sig) %>%
select(variable, PFA, everything()) %>%
kable() %>% kable_styling(bootstrap_options=c('striped'))
# Forest type diversity.
proportion.squirrel.by.bec.diversity <- data %>%
drop_na(proportion.squirrel) %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ bec.diversity, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='forest type diversity')
# Proportion older forest.
proportion.squirrel.by.proportion.cover.mature <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ proportion.cover.mature, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='proportion older forest')
# Landcover edge density.
proportion.squirrel.by.cover.edge.density <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ cover.edge.density, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='landcover edge density')
# Landcover contagion.
proportion.squirrel.by.cover.contagion <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ cover.contagion, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='landcover contagion')
# Landcover diversity.
proportion.squirrel.by.cover.diversity <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ cover.diversity, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='landcover diversity')
# Landcover evenness.
proportion.squirrel.by.cover.evenness <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ cover.evenness, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='landcover evenness')
# Landcover richness.
proportion.squirrel.by.cover.richness <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ cover.richness, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='landcover richness')
# HSI edge density.
proportion.squirrel.by.hsi.edge.density <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ hsi.edge.density, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='hsi edge density')
# HSI contagion.
proportion.squirrel.by.hsi.contagion <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ hsi.contagion, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='hsi contagion')
# Proportion suitable.
proportion.squirrel.by.proportion.suitable <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ proportion.suitable, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='proportion suitable')
# Suitable habitat edge density.
proportion.squirrel.by.suitable.edge.density <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ suitable.edge.density, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='suitable habitat edge density')
View(data)
# Forest type diversity.
proportion.squirrel.by.bec.diversity <- data %>%
drop_na(proportion.squirrel) %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ bec.diversity, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='forest type diversity')
# Proportion older forest.
proportion.squirrel.by.proportion.cover.mature <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ proportion.cover.mature, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='proportion older forest')
# Landcover edge density.
proportion.squirrel.by.cover.edge.density <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ cover.edge.density, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='landcover edge density')
# Landcover contagion.
proportion.squirrel.by.cover.contagion <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ cover.contagion, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='landcover contagion')
# Landcover diversity.
proportion.squirrel.by.cover.diversity <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ cover.diversity, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='landcover diversity')
# Landcover evenness.
proportion.squirrel.by.cover.evenness <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ cover.evenness, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='landcover evenness')
# Landcover richness.
proportion.squirrel.by.cover.richness <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ cover.richness, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='landcover richness')
# HSI edge density.
proportion.squirrel.by.hsi.edge.density <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ hsi.edge.density, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='hsi edge density')
# HSI contagion.
proportion.squirrel.by.hsi.contagion <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ hsi.contagion, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='hsi contagion')
# Proportion suitable.
proportion.squirrel.by.proportion.suitable <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ proportion.suitable, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='proportion suitable')
# Suitable habitat edge density.
proportion.squirrel.by.suitable.edge.density <- data %>%
drop_na(proportion.squirrel) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(proportion.squirrel ~ suitable.edge.density, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='suitable habitat edge density')
# Bind it all together.
proportion.squirrel.statistics <- bind_rows(proportion.squirrel.by.bec.diversity,
proportion.squirrel.by.proportion.cover.mature,
proportion.squirrel.by.cover.edge.density,
proportion.squirrel.by.cover.contagion,
proportion.squirrel.by.cover.diversity,
proportion.squirrel.by.cover.evenness,
proportion.squirrel.by.cover.richness,
proportion.squirrel.by.hsi.edge.density,
proportion.squirrel.by.hsi.contagion,
proportion.squirrel.by.proportion.suitable,
proportion.squirrel.by.suitable.edge.density)
proportion.squirrel.statistics <- proportion.squirrel.statistics %>%
mutate(sig=round(p.value, digits=2)) %>%
mutate(sig=case_when(
p.value < 0.1 ~ paste(as.character(sig), '*'),
TRUE ~  paste(as.character(sig))
))
proportion.squirrel.statistics %>% select(size, sig, variable) %>%
pivot_wider(names_from=size, values_from=sig) %>%
select(variable, PFA, everything()) %>%
kable() %>% kable_styling(bootstrap_options=c('striped'))
View(camera.sites.2019)
camera.site
camera.sites
camera.sites.2019
View(camera.sites.sf)
camera.sites.2019 %>% select(nest, n_fledge)
camera.sites.2019 %>% select(nest, n_fledge) %>% full_join(data, by=c('nest'))
camera.sites.2019 %>% select(nest, n_fledge) %>% full_join(data, by=c('nest')) %>% view()
data <- camera.sites.2019 %>% select(nest, n_fledge) %>% full_join(data, by=c('nest'))
proportion.squirrel.statistics %>% select(size, sig, variable) %>%
pivot_wider(names_from=size, values_from=sig) %>%
select(variable, PFA, everything()) %>%
kable() %>% kable_styling(bootstrap_options=c('striped'))
View(data)
# Diet diversity.
productivity.by.diet.diversity <- data %>%
split(.$size) %>%
map(~lm(n_fledge ~ diet.diversity, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='diet diversity')
# Proportion squirrel.
productivity.by.proportion.squirrel <- data %>%
split(.$size) %>%
map(~lm(productivity ~ proportion.squirrel, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='proportion squirrel')
# Proportion squirrel.
productivity.by.proportion.squirrel <- data %>%
split(.$size) %>%
map(~lm(n_fledge ~ proportion.squirrel, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='proportion squirrel')
# Diet diversity.
productivity.by.diet.diversity <- data %>%
split(.$size) %>%
map(~lm(n_fledge ~ diet.diversity, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='diet diversity')
# Proportion squirrel.
productivity.by.proportion.squirrel <- data %>%
split(.$size) %>%
map(~lm(n_fledge ~ proportion.squirrel, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='proportion squirrel')
# Bind it all together.
productivity.diet.statistics <- bind_rows(productivity.by.diet.diversity,
productivity.by.proportion.squirrel)
productivity.diet.statistics <- productivity.diet.statistics %>%
mutate(sig=round(p.value, digits=2)) %>%
mutate(sig=case_when(
p.value < 0.1 ~ paste(as.character(sig), '*'),
TRUE ~  paste(as.character(sig))
))
productivity.diet.statistics %>% select(size, sig, variable) %>%
pivot_wider(names_from=size, values_from=sig) %>%
select(variable, PFA, everything()) %>%
kable() %>% kable_styling(bootstrap_options=c('striped'))
knitr::opts_chunk$set(echo=TRUE, message=FALSE, warning=FALSE)
# Forest type diversity.
productivity.by.bec.diversity <- data %>%
drop_na(n_fledge) %>%
split(.$size) %>%
map(~lm(n_fledge ~ bec.diversity, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='forest type diversity')
# Proportion older forest.
productivity.by.proportion.cover.mature <- data %>%
drop_na(n_fledge) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(n_fledge ~ proportion.cover.mature, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='proportion older forest')
# Landcover edge density.
productivity.by.cover.edge.density <- data %>%
drop_na(n_fledge) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(n_fledge ~ cover.edge.density, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='landcover edge density')
# Landcover contagion.
productivity.by.cover.contagion <- data %>%
drop_na(n_fledge) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(n_fledge ~ cover.contagion, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='landcover contagion')
# Landcover diversity.
productivity.by.cover.diversity <- data %>%
drop_na(n_fledge) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(n_fledge ~ cover.diversity, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='landcover diversity')
# Landcover evenness.
productivity.by.cover.evenness <- data %>%
drop_na(n_fledge) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(n_fledge ~ cover.evenness, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='landcover evenness')
# Landcover richness.
productivity.by.cover.richness <- data %>%
drop_na(n_fledge) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(n_fledge ~ cover.richness, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='landcover richness')
# HSI edge density.
productivity.by.hsi.edge.density <- data %>%
drop_na(n_fledge) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(n_fledge ~ hsi.edge.density, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='hsi edge density')
# HSI contagion.
productivity.by.hsi.contagion <- data %>%
drop_na(n_fledge) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(n_fledge ~ hsi.contagion, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='hsi contagion')
# Proportion suitable.
productivity.by.proportion.suitable <- data %>%
drop_na(n_fledge) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(n_fledge ~ proportion.suitable, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='proportion suitable')
# Suitable habitat edge density.
productivity.by.suitable.edge.density <- data %>%
drop_na(n_fledge) %>%
filter(nest != 'TCR2019') %>%
split(.$size) %>%
map(~lm(n_fledge ~ suitable.edge.density, data=.x)) %>%
map(summary) %>%
map(glance) %>%
bind_rows(.id='size') %>%
mutate(variable='suitable habitat edge density')
# Bind it all together.
productivity.landscape.statistics <- bind_rows(productivity.by.bec.diversity,
productivity.by.proportion.cover.mature,
productivity.by.cover.edge.density,
productivity.by.cover.contagion,
productivity.by.cover.diversity,
productivity.by.cover.evenness,
productivity.by.cover.richness,
productivity.by.hsi.edge.density,
productivity.by.hsi.contagion,
productivity.by.proportion.suitable,
productivity.by.suitable.edge.density)
productivity.landscape.statistics <- productivity.landscape.statistics %>%
mutate(sig=round(p.value, digits=2)) %>%
mutate(sig=case_when(
p.value < 0.1 ~ paste(as.character(sig), '*'),
TRUE ~  paste(as.character(sig))
))
productivity.landscape.statistics %>% select(size, sig, variable) %>%
pivot_wider(names_from=size, values_from=sig) %>%
select(variable, PFA, everything()) %>%
kable() %>% kable_styling(bootstrap_options=c('striped'))
