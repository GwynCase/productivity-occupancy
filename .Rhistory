library(rmapshaper)
library(ggspatial)
library(vegan)
# Make a function to round percents nicely.
peretty <- function(x, p=2) {
as.numeric(x) %>%
round(p)
}
# Read in nest data.
nests <- read_csv('../data/processed/sc_nests.csv')
# Calculate a centroid for each site.
centroids <- nests %>% group_by(site) %>%
mutate(xcoord=mean(xcoord), ycoord=mean(ycoord)) %>%
distinct(site, name, xcoord, ycoord) %>% ungroup()
# Make it a spatial object for later.
centroids.sf <- centroids %>%
st_as_sf(coords=c('xcoord', 'ycoord')) %>%
st_set_crs('+proj=utm +zone=10 +datum=WGS84 +units=m +no_defs') %>%
st_as_sf()
# Bring in study area shapefile.
sc.region <- read_sf(dsn='../data/external/SC_land.shp', layer='SC_land')
tz.region <- read_sf(dsn='../data/processed/new_transition_zone.shp',
layer='new_transition_zone') %>%
ms_simplify()
# Add zone information to centroids.
centroids.sf <- centroids.sf %>% mutate(
zone=as.integer(st_intersects(geometry, tz.region)),
zone=case_when(
is.na(zone) ~ 'cs',
TRUE ~ 'tz'
)
)
# Bring in some base data.
n.america <- read_sf(dsn='../data/external/ne_10m_land.shp', layer='ne_10m_land')
rivers <- read_sf(dsn='../data/external/ne_10m_rivers_lake_centerlines.shp',
layer='ne_10m_rivers_lake_centerlines')
# Make a reference point for Vancouver.
vancouver <- data.frame(x=-123.113889, y=49.260833, name='Vancouver')
# Make the map.
ggplot() +
geom_sf(data=n.america, fill='white') +
geom_sf(data=sc.region, fill='lightgrey') +
geom_sf(data=tz.region, fill='darkgrey', color=NA) +
geom_sf(data=rivers) +
coord_sf(xlim=c(st_bbox(sc.region)[1] - 0.5, st_bbox(sc.region)[3] + 0.5),
ylim=c(st_bbox(sc.region)[2] - 0.25, st_bbox(sc.region)[4] + 0.25)) +
theme_void() +
theme(panel.background=element_rect(fill='black'),
panel.border=element_rect(color='black', fill=NA)) +
annotation_scale(location='br') +
annotation_north_arrow(location='br', which_north='true',
pad_y=unit(1, 'cm'), style=north_arrow_minimal) +
#geom_sf_text(data=rivers, aes(label=paste(name, featurecla)), nudge_y= -0.20)
geom_point(data=vancouver, aes(x=x, y=y)) +
geom_label(data=vancouver, aes(x=x, y=y, label=name), nudge_x=0.6, nudge_y=-0.1)
# Bring in specimen data.
remains.data <- read_csv('../data/processed/specimens_20210318.csv', guess_max=7000) %>%
## filter only records with at least size assigned...
filter(size != 'U')
# Bring in camera data.
camera.data <- read_csv('../data/interim/cameras_20210315.csv', guess_max=7000) %>%
## filter only records with at least size assigned...
filter(size != 'U')
# Bring in a list of site abbreviations and site names.
nest.list <- read_csv('../data/processed/site_abbreviations.csv')
# Standardize the specimen data.
remains.data <- left_join(remains.data, nest.list, by=c('name', 'site')) %>%
select(site, date, class, order, family, genus, species, common, size, source)
# Standardize the camera data.
camera.data <- camera.data %>%
mutate(date=date(datetime), source='C') %>%
select(site, date, class, order, family, genus, species, common, size, source)
# Join them together.
diet.data <- bind_rows(remains.data, camera.data)
# Add a unique site/year identifier.
diet.data <- diet.data %>%
mutate(year=year(date), nest=paste(site, year, sep=''))
# Do some cleanup.
diet.data <- diet.data %>%
mutate(size=case_when(
size %in% c('S', 'Small') ~ 'small',
size %in% c('M', 'Medium') ~ 'medium',
size %in% c('L', 'Large') ~ 'large'
))
productivity <- read_csv('../data/raw/productivity.csv')
# Bring in a list of all known prey.
prey.list <- read_csv('../data/interim/prey_attributes.csv')
# Join the biomass data to the list of diet items.
diet.items <- prey.list %>% select(genus, species, binomial, common, category, mass) %>%
right_join(diet.data, by=c('genus', 'species', 'common'))
# For unidentified items, classify them by size and class.
diet.items <- diet.items %>% mutate(category=case_when(
is.na(category) & class == 'Mammalia' & size == 'small' ~ 'small mammal',
is.na(category) & class == 'Mammalia' & size == 'medium' ~ 'medium mammal',
is.na(category) & class == 'Mammalia' & size == 'large' ~ 'large mammal',
is.na(category) & class == 'Aves' & size == 'small' ~ 'small bird',
is.na(category) & class == 'Aves' & size == 'medium' ~ 'medium bird',
is.na(category) & class == 'Aves' & size == 'large' ~ 'large bird',
is.na(category) & class == 'Unknown' ~ paste(size, 'item'),
TRUE ~ category))
# For unidentified items, fill in the binomial column.
diet.items <- diet.items %>% replace_na(list(binomial = 'Unidentified item'))
# Calculate average masses for unidentified items, based of known species.
mean.mass <- diet.items %>% drop_na(mass) %>%
distinct(binomial, mass, category) %>%
group_by(category) %>%
## averaging the mass for each size & class category...
summarize(average=mean(mass)) %>%
pivot_wider(names_from=category, values_from=average) %>%
## calculating the average mass for complete unknowns...
mutate(`large item` = mean(c(`large bird`, `large mammal`)),
`medium item` = mean(c(`medium bird`, `medium mammal`)),
`small item` = mean(c(`small bird`, `small mammal`))) %>%
## and reassembling it in a tidy format.
pivot_longer(everything(), names_to='category', values_to='average')
# Join average mass to diet items...
diet.items <- left_join(diet.items, mean.mass, by='category') %>%
## and fill in missing mass with average values
mutate(mass=coalesce(mass, average)) %>%
## then drop no longer needed average column and rearrange.
select(site, year, nest, class, order, family, genus, species, binomial, common,
category, size, mass, age, source)
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)
# Import conflict settings.
source('../src/conflicted.R')
# Load some libraries.
library(tidyverse)
library(lubridate)
library(sf)
library(rmapshaper)
library(ggspatial)
library(vegan)
# Make a function to round percents nicely.
peretty <- function(x, p=2) {
as.numeric(x) %>%
round(p)
}
# Read in nest data.
nests <- read_csv('../data/processed/sc_nests.csv')
# Calculate a centroid for each site.
centroids <- nests %>% group_by(site) %>%
mutate(xcoord=mean(xcoord), ycoord=mean(ycoord)) %>%
distinct(site, name, xcoord, ycoord) %>% ungroup()
# Make it a spatial object for later.
centroids.sf <- centroids %>%
st_as_sf(coords=c('xcoord', 'ycoord')) %>%
st_set_crs('+proj=utm +zone=10 +datum=WGS84 +units=m +no_defs') %>%
st_as_sf()
# Bring in study area shapefile.
sc.region <- read_sf(dsn='../data/external/SC_land.shp', layer='SC_land')
tz.region <- read_sf(dsn='../data/processed/new_transition_zone.shp',
layer='new_transition_zone') %>%
ms_simplify()
# Add zone information to centroids.
centroids.sf <- centroids.sf %>% mutate(
zone=as.integer(st_intersects(geometry, tz.region)),
zone=case_when(
is.na(zone) ~ 'cs',
TRUE ~ 'tz'
)
)
# Bring in some base data.
n.america <- read_sf(dsn='../data/external/ne_10m_land.shp', layer='ne_10m_land')
rivers <- read_sf(dsn='../data/external/ne_10m_rivers_lake_centerlines.shp',
layer='ne_10m_rivers_lake_centerlines')
# Make a reference point for Vancouver.
vancouver <- data.frame(x=-123.113889, y=49.260833, name='Vancouver')
# Make the map.
ggplot() +
geom_sf(data=n.america, fill='white') +
geom_sf(data=sc.region, fill='lightgrey') +
geom_sf(data=tz.region, fill='darkgrey', color=NA) +
geom_sf(data=rivers) +
coord_sf(xlim=c(st_bbox(sc.region)[1] - 0.5, st_bbox(sc.region)[3] + 0.5),
ylim=c(st_bbox(sc.region)[2] - 0.25, st_bbox(sc.region)[4] + 0.25)) +
theme_void() +
theme(panel.background=element_rect(fill='black'),
panel.border=element_rect(color='black', fill=NA)) +
annotation_scale(location='br') +
annotation_north_arrow(location='br', which_north='true',
pad_y=unit(1, 'cm'), style=north_arrow_minimal) +
#geom_sf_text(data=rivers, aes(label=paste(name, featurecla)), nudge_y= -0.20)
geom_point(data=vancouver, aes(x=x, y=y)) +
geom_label(data=vancouver, aes(x=x, y=y, label=name), nudge_x=0.6, nudge_y=-0.1)
# Bring in specimen data.
remains.data <- read_csv('../data/processed/specimens_20210318.csv', guess_max=7000) %>%
## filter only records with at least size assigned...
filter(size != 'U')
# Bring in camera data.
camera.data <- read_csv('../data/interim/cameras_20210315.csv', guess_max=7000) %>%
## filter only records with at least size assigned...
filter(size != 'U')
# Bring in a list of site abbreviations and site names.
nest.list <- read_csv('../data/processed/site_abbreviations.csv')
# Standardize the specimen data.
remains.data <- left_join(remains.data, nest.list, by=c('name', 'site')) %>%
select(site, date, class, order, family, genus, species, common, size, age, source)
# Standardize the camera data.
camera.data <- camera.data %>%
mutate(date=date(datetime), source='C') %>%
select(site, date, class, order, family, genus, species, common, size, age, source)
# Join them together.
diet.data <- bind_rows(remains.data, camera.data)
# Add a unique site/year identifier.
diet.data <- diet.data %>%
mutate(year=year(date), nest=paste(site, year, sep=''))
# Do some cleanup.
diet.data <- diet.data %>%
mutate(size=case_when(
size %in% c('S', 'Small') ~ 'small',
size %in% c('M', 'Medium') ~ 'medium',
size %in% c('L', 'Large') ~ 'large'
))
productivity <- read_csv('../data/raw/productivity.csv')
# Bring in a list of all known prey.
prey.list <- read_csv('../data/interim/prey_attributes.csv')
# Join the biomass data to the list of diet items.
diet.items <- prey.list %>% select(genus, species, binomial, common, category, mass) %>%
right_join(diet.data, by=c('genus', 'species', 'common'))
# For unidentified items, classify them by size and class.
diet.items <- diet.items %>% mutate(category=case_when(
is.na(category) & class == 'Mammalia' & size == 'small' ~ 'small mammal',
is.na(category) & class == 'Mammalia' & size == 'medium' ~ 'medium mammal',
is.na(category) & class == 'Mammalia' & size == 'large' ~ 'large mammal',
is.na(category) & class == 'Aves' & size == 'small' ~ 'small bird',
is.na(category) & class == 'Aves' & size == 'medium' ~ 'medium bird',
is.na(category) & class == 'Aves' & size == 'large' ~ 'large bird',
is.na(category) & class == 'Unknown' ~ paste(size, 'item'),
TRUE ~ category))
# For unidentified items, fill in the binomial column.
diet.items <- diet.items %>% replace_na(list(binomial = 'Unidentified item'))
# Calculate average masses for unidentified items, based of known species.
mean.mass <- diet.items %>% drop_na(mass) %>%
distinct(binomial, mass, category) %>%
group_by(category) %>%
## averaging the mass for each size & class category...
summarize(average=mean(mass)) %>%
pivot_wider(names_from=category, values_from=average) %>%
## calculating the average mass for complete unknowns...
mutate(`large item` = mean(c(`large bird`, `large mammal`)),
`medium item` = mean(c(`medium bird`, `medium mammal`)),
`small item` = mean(c(`small bird`, `small mammal`))) %>%
## and reassembling it in a tidy format.
pivot_longer(everything(), names_to='category', values_to='average')
# Join average mass to diet items...
diet.items <- left_join(diet.items, mean.mass, by='category') %>%
## and fill in missing mass with average values
mutate(mass=coalesce(mass, average)) %>%
## then drop no longer needed average column and rearrange.
select(site, year, nest, class, order, family, genus, species, binomial, common,
category, size, mass, age, source)
# Change mass for juvenile items.
diet.items <- diet.items %>% mutate(mass=case_when(
age == 'J' ~ 0.5*mass,
TRUE ~ mass
))
# Add grouping categories.
diet.items <- diet.items %>% mutate(group=case_when(
class == 'Aves' & family == 'Phasianidae' ~ 'grouse',
class == 'Aves' & family == 'Corvidae' ~ 'corvid',
class == 'Aves' & family == 'Turdidae' ~ 'thrush',
class == 'Aves' ~ 'bird',
class == 'Mammalia' & genus == 'Tamiasciurus' ~ 'squirrel',
class == 'Mammalia' & genus == 'Lepus' ~ 'hare',
class == 'Mammalia' ~ 'mammal',
TRUE ~ 'unknown'
))
# Make a function to calculate class mass.
class.mass <- function(data) {
data %>% mutate(total.mass=sum(.data$mass)) %>%
filter(class %in% c('Mammalia', 'Aves')) %>%
group_by(class) %>%
mutate(class.mass=sum(.data$mass), per.class=class.mass/total.mass*100) %>%
distinct(class, per.class) %>%
rename(variable=class, percent=per.class)
}
# And a function to calculate squirrel mass.
squirrel.mass <- function(data) {
data %>% mutate(total.mass=sum(.data$mass)) %>%
filter(genus == 'Tamiasciurus') %>%
mutate(genus.mass=sum(.data$mass), per.genus=genus.mass/total.mass*100) %>%
distinct(genus, per.genus) %>%
rename(variable=genus, percent=per.genus)
}
# And a function to calculate mass of each group.
group.mass <- function(data) {
data %>% mutate(total.mass=sum(.data$mass)) %>%
group_by(group) %>%
mutate(group.mass=sum(.data$mass), per.group=group.mass/total.mass*100) %>%
distinct(group, per.group) %>%
rename(variable=group, percent=per.group)
}
# Calculate biomass for study area.
study.area.mass <- diet.items %>% group_by(source) %>% nest() %>%
mutate(class=map(data, class.mass),
genus=map(data, squirrel.mass),
group=map(data, group.mass)) %>%
pivot_longer(-c(source, data), names_to='var', values_to='per') %>%
unnest(per) %>%
select(source, variable, percent) %>%
pivot_wider(names_from=source, values_from=percent, values_fill=0) %>%
mutate(R.P=R + P)
# Calculate percent mass for each nest.
nest.mass <- diet.items %>% filter(source == 'C') %>%
group_by(nest) %>% nest() %>%
mutate(class=map(data, class.mass),
genus=map(data, squirrel.mass),
group=map(data, group.mass)) %>%
pivot_longer(-c(nest, data), names_to='var', values_to='per') %>%
unnest(per) %>%
select(nest, variable, percent) %>%
pivot_wider(id_cols=c(nest), names_from=variable, values_from=percent, values_fill=0)
# Calculate counts of items identified to genus for entire study area.
study.area.count <- diet.items %>% filter(source == 'C' & binomial != 'Unidentified item') %>%
group_by(binomial) %>%
mutate(count=n()) %>%
select(binomial, count) %>%
distinct() %>%
pivot_wider(names_from=binomial, values_from=count, values_fill=list(count = 0))
# Calculate counts of items identified to genus for each nest.
nest.count <- diet.items %>% filter(source == 'C' & binomial != 'Unidentified item') %>%
group_by(nest, binomial) %>%
mutate(count=n()) %>%
select(nest, binomial, count) %>%
distinct() %>%
pivot_wider(names_from=binomial, values_from=count, values_fill=list(count = 0))
# Total study area diversity.
# diversity(study.area.count, index='simpson')
# Diversity per nest.
nest.diversity <- plyr::ddply(nest.count, ~nest, function(x) {
data.frame(diet.diversity=diversity(x[-1], index='simpson'))
})
# Calculate overlap between nests.
nest.overlap <- nest.count %>% column_to_rownames(var='nest') %>%
vegdist(., method='morisita') %>%
enframe()
# Calculate % biomass for each source and each zone.
zone.mass <- left_join(diet.items, centroids.sf, by=c('site')) %>%
group_by(zone, source) %>% nest() %>%
mutate(class=map(data, class.mass),
genus=map(data, squirrel.mass),
group=map(data, group.mass)) %>%
select(!data) %>%
pivot_longer(-c(source, zone), names_to='var', values_to='per') %>%
unnest(per) %>%
select(source, zone, variable, percent) %>%
pivot_wider(id_cols=c(zone, variable), names_from=source, values_from=percent, values_fill=0) %>%
mutate(R.P=R + P) %>%
arrange(zone)
# Calculate counts per group per zone per source.
zone.counts <- left_join(diet.items, centroids.sf, by=c('site')) %>%
group_by(source) %>% nest() %>%
mutate(count=map(data, function(data) {
data %>% group_by(zone, group) %>%
mutate(count=n()) %>%
select(zone, group, count) %>%
distinct()
})) %>%
unnest(count) %>% select(!data)
# Run a chi-square test for each data source.
zone.chi <- zone.counts %>% group_by(source) %>% nest() %>%
mutate(ch=map(data, function(data) {
data %>% pivot_wider(names_from=group, values_from=count, values_fill=0) %>%
column_to_rownames(var='zone') %>%
chisq.test(., correct=FALSE, simulate.p.value=TRUE)
}))
# Make a happy data set for the models to use.
model.data <- productivity %>% mutate(nest=paste(site, year, sep='')) %>%
left_join(nest.diversity, by=c('nest')) %>%
left_join(nest.mass, by=c('nest')) %>%
select(site, year, nest, n.fledge, diet.diversity, squirrel) %>%
filter_all(all_vars(!is.na(.)))
# Make the models.
diversity.model <- lm(n.fledge ~ diet.diversity, data=model.data)
squirrel.model <- lm(n.fledge ~ squirrel, data=model.data)
diet.items %>% filter(source != 'C') %>% mutate(total=sum(mass)) %>%
group_by(category) %>% mutate(gmass=sum(mass), pmass=gmass/total) %>%
distinct(category, pmass)
diet.items %>% filter(source != 'C') %>% mutate(total=sum(mass)) %>%
group_by(group) %>% mutate(gmass=sum(mass), pmass=gmass/total) %>%
distinct(group, pmass)
diet.items %>% filter(source != 'C') %>% mutate(total=sum(mass)) %>%
group_by(group) %>% mutate(gmass=sum(mass), pmass=gmass/total) %>%
distinct(group, pmass) %>% arrange(desc(pmass))
diet.items %>% filter(source != 'C') %>% mutate(total=sum(mass)) %>%
group_by(class) %>% mutate(gmass=sum(mass), pmass=gmass/total) %>%
distinct(class, pmass) %>% arrange(desc(pmass))
filter(diet.items, source == 'C')
filter(diet.items, source == 'C') %>% summarize(n())
filter(diet.items, source == 'C') %>% summarize(n()) %>% as.numeric()
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(n()) %>% as.numeric()
View(diet.items)
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(n())
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(n=n(), m=mean(n))
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(n=n())
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(n=n()) %>% mean(n)
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(n=n()) %>% ungroup() %>% mean(n)
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(n=n(), .groups='drop')
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(n=n(), .groups='drop') %>% mean(n)
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(n=n(), .groups='drop') %>% mean(.$n)
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(n=n(), .groups='drop') %>% summarize(mean(n))
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(n=n(), m=mean(n), .groups='drop') #%>% summarize(mean(n))
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(n=n(), .groups='drop') %>% summarize(mean(n)) %>% as.numeric()
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(n=n(), .groups='drop') %>% summarize(mean(n)) %>% peretty(0)
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(m=min(), .groups='drop') %>% summarize(mean(n)) %>% peretty(0)
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(m=min(), .groups='drop') %>% peretty(0)
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(n=n(), .groups='drop') %>% min(n)
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(n=n(), .groups='drop') %>% summarize(min(n))
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(n=n(), .groups='drop') %>% summarize(max(n)) %>% as.numeric()
filter(diet.items, source == 'C') %>% group_by(nest) %>% summarize(n=n(), .groups='drop') %>% summarize(min(n)) %>% as.numeric()
# Bring in camera data.
photos <- read_csv('../data/interim/cameras_20210315.csv', guess_max=7000)
photos %>% head()
photos %>% distinct(interst)
photos %>% distinct(interest)
photos %>% nrow()
photos %>% filter(!is.na(class))
photos %>% filter(!is.na(class)) %>% nrow() %>% as.numeric()
photos %>% filter(size == 'U') %>% nrow() %>% as.numeric()
# Counts
filter(diet.items, source == 'C') %>% mutate(total=n()) %>% filter(class != 'Unknown') %>% mutate(count=n(), to.count=count/total*100) %>% distinct(to.count) %>% peretty(0)
# Counts
filter(diet.items, source == 'C') %>% mutate(total=n()) %>% filter(genus != 'Unknown') %>% mutate(count=n(), to.count=count/total*100) %>% distinct(to.count) %>% peretty(0)
diet.items %>% group_by(category, class) %>% summarize(n())
diet.items %>% group_by(category, class) %>% summarize(n()) %>% arrange(class)
diet.items %>% group_by(category, class, order) %>% summarize(n()) %>% arrange(class)
diet.items %>% filter(order == 'Unknown') %>% group_by(category, class) %>% summarize(n()) %>% arrange(class)
diet.items %>% filter(order == 'Unknown') %>%
mutate(total=n()) #group_by(category, class) %>% summarize(n()) %>% arrange(class)
diet.items %>% filter(order == 'Unknown') %>%
mutate(total=n()) %>% group_by(category, class) %>% mutate(unk=n(), punk=unk/total) %>%
distinct(category, class, punk)
diet.items %>% filter(order == 'Unknown') %>%
mutate(total=n()) %>% group_by(category, class) %>% mutate(unk=n(), punk=unk/total) %>%
distinct(category, class, punk) %>% arrange(punk)
diet.items %>% filter(source =='C' & order == 'Unknown') %>%
mutate(total=n()) %>% group_by(category, class) %>% mutate(unk=n(), punk=unk/total) %>%
distinct(category, class, punk) %>% arrange(punk)
filter(diet.items, source == 'C') %>% distinct(binomial)
filter(diet.items, source == 'C') %>% distinct(binomial) %>% view()
filter(diet.items, source == 'C') %>% distinct(binomial) %>% nrow() -1
filter(diet.items, source == 'C') %>% distinct(binomial) %>% nrow()
# Biomass
filter(diet.items, source != 'C') %>% mutate(total=sum(mass)) %>% filter(class == 'Mammalia') %>% mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(to.mass) %>% peretty(0)
# Biomass
filter(diet.items, source == 'C') %>% mutate(total=sum(mass)) %>% filter(class == 'Mammalia') %>% mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(to.mass) %>% peretty(0)
# Counts
filter(diet.items, source == 'C') %>% mutate(total=n()) %>% filter(class != 'Mammalia') %>% mutate(count=n(), to.count=count/total*100) %>% distinct(to.count) %>% peretty(0)
filter(diet.items, source == 'C') %>% mutate(total=sum(mass)) %>% filter(class == 'Mammalia') %>% grou_by(nest) %>% mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(nest, to.mass) #%>% peretty(0)
filter(diet.items, source == 'C') %>% mutate(total=sum(mass)) %>% filter(class == 'Mammalia') %>% group_by(nest) %>% mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(nest, to.mass) #%>% peretty(0)
filter(diet.items, source == 'C') %>% group_by(nest) %>% mutate(total=sum(mass)) %>% filter(class == 'Mammalia') %>% mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(nest, to.mass) #%>% peretty(0)
filter(diet.items, source == 'C') %>% group_by(nest) %>% mutate(total=sum(mass)) %>% filter(class == 'Mammalia') %>% mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(nest, to.mass) %>% summarize(m=mean(to.mass, .groups='drop')) %>% peretty(0)
filter(diet.items, source == 'C') %>% group_by(nest) %>% mutate(total=sum(mass)) %>% filter(class == 'Mammalia') %>% mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(nest, to.mass) %>% summarize(m=mean(to.mass, .groups='drop')) #%>% peretty(0)
filter(diet.items, source == 'C') %>% group_by(nest) %>% mutate(total=sum(mass)) %>% filter(class == 'Mammalia') %>% mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(nest, to.mass) #%>% summarize(m=mean(to.mass, .groups='drop')) #%>% peretty(0)
filter(diet.items, source == 'C') %>% group_by(nest) %>% mutate(total=sum(mass)) %>% filter(class == 'Mammalia') %>% mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(nest, to.mass) %>% summarize(m=mean(to.mass, .groups='drop')) #%>% peretty(0)
filter(diet.items, source == 'C') %>% group_by(nest) %>% mutate(total=sum(mass)) %>% filter(class == 'Mammalia') %>% mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(nest, to.mass) %>% ungroup()
filter(diet.items, source == 'C') %>% group_by(nest) %>% mutate(total=sum(mass)) %>% filter(class == 'Mammalia') %>% mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(nest, to.mass) %>% ungroup() %>% summarize(mean(to.mass))
filter(diet.items, source == 'C') %>% group_by(nest) %>% mutate(total=sum(mass)) %>% filter(class == 'Mammalia') %>% mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(nest, to.mass) %>% ungroup() %>% summarize(mean(to.mass)) %>% peretty(0)
filter(diet.items, source == 'C') %>% group_by(nest) %>% mutate(total=sum(mass)) %>% filter(class == 'Mammalia') %>% mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(nest, to.mass) %>% ungroup() %>% summarize(sd(to.mass)) %>% peretty(0)
model.data
summary(squirrel.model)
# Biomass
filter(diet.items, source == 'C') %>% mutate(total=sum(mass)) %>% filter(class == 'Aves') %>% mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(to.mass) %>% peretty(0)
percent.avian.biomass.study.area <- filter(diet.items, source == 'C') %>%
mutate(total=sum(mass)) %>% filter(class == 'Aves') %>%
mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(to.mass) %>% peretty(0)
count.avian.items.study.area <- filter(diet.items, source == 'C') %>%
mutate(total=n()) %>% filter(class != 'Aves') %>%
mutate(count=n(), to.count=count/total*100) %>% distinct(to.count) %>% peretty(0)
# Calculate mean percent avian biomass per nest.
percent.avian.biomass.nest <- filter(diet.items, source == 'C') %>% group_by(nest) %>%
mutate(total=sum(mass)) %>% filter(class == 'Aves') %>%
mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(nest, to.mass) %>%
ungroup() %>% summarize(mean(to.mass)) %>% peretty(0)
# Calculate standard deviation of avian biomass per nest.
sd.avian.biomass.nest <- filter(diet.items, source == 'C') %>% group_by(nest) %>%
mutate(total=sum(mass)) %>% filter(class == 'Aves') %>%
mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(nest, to.mass) %>%
ungroup() %>% summarize(mean(to.mass)) %>% peretty(0)
# Calculate standard deviation of avian biomass per nest.
sd.avian.biomass.nest <- filter(diet.items, source == 'C') %>% group_by(nest) %>%
mutate(total=sum(mass)) %>% filter(class == 'Aves') %>%
mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(nest, to.mass) %>%
ungroup() %>% summarize(sd(to.mass)) %>% peretty(0)
# Calculate percent avian biomass for camera data for the entire study area.
percent.unknown.biomass.study.area <- filter(diet.items, source == 'C') %>%
mutate(total=sum(mass)) %>% filter(class == 'Unknown') %>%
mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(to.mass) %>% peretty(0)
# Calculate percent counts of avian items for camera data for the entire study area.
count.avian.items.study.area <- filter(diet.items, source == 'C') %>%
mutate(total=n()) %>% filter(class == 'Aves') %>%
mutate(count=n(), to.count=count/total*100) %>% distinct(to.count) %>% peretty(0)
# Calculate percent counts of unidentified items for camera data for the entire study area.
count.unknown.items.study.area <- filter(diet.items, source == 'C') %>%
mutate(total=n()) %>% filter(class == 'Unknown') %>%
mutate(count=n(), to.count=count/total*100) %>% distinct(to.count) %>% peretty(0)
# Calculate mean percent avian biomass per nest.
percent.unknown.biomass.nest <- filter(diet.items, source == 'C') %>% group_by(nest) %>%
mutate(total=sum(mass)) %>% filter(class == 'Unknown') %>%
mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(nest, to.mass) %>%
ungroup() %>% summarize(mean(to.mass)) %>% peretty(0)
# Calculate standard deviation of avian biomass per nest.
sd.unknown.biomass.nest <- filter(diet.items, source == 'C') %>% group_by(nest) %>%
mutate(total=sum(mass)) %>% filter(class == 'Unknown') %>%
mutate(mass=sum(mass), to.mass=mass/total*100) %>% distinct(nest, to.mass) %>%
ungroup() %>% summarize(sd(to.mass)) %>% peretty(0)
filter(diet.items, source == 'C')
filter(diet.items, source == 'C') %>% mutate(total=sum(mass)) %>%
group_by(group) %>% mutate(mass=sum(mass), gmass=mass/total)
filter(diet.items, source == 'C') %>% mutate(total=sum(mass)) %>%
group_by(group) %>% mutate(mass=sum(mass), gmass=mass/total) %>%
distinct(group, gmass) %>% arrange(desc(gmass))
